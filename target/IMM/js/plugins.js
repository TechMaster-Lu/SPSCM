function openWindow(e){var t;(t=window.open("","_blank","top=0,left=0,width="+window.innerWidth+",height="+window.innerHeight+",toolbar=no,menubar=no")).document.write(e),t.document.close(),t.focus(),t.print(),t.onafterprint=function(){t.close()}}function accDiv(e,t){var i,n,a=0,o=0;try{a=e.toString().split(".")[1].length}catch(e){}try{o=t.toString().split(".")[1].length}catch(e){}return i=Number(e.toString().replace(".","")),n=Number(t.toString().replace(".","")),i/n*Math.pow(10,o-a)}function accMul(e,t){var i=0,n=e.toString(),a=t.toString();try{i+=n.split(".")[1].length}catch(e){}try{i+=a.split(".")[1].length}catch(e){}return Number(n.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,i)}function accAdd(e,t){var i,n,a;try{i=e.toString().split(".")[1].length}catch(e){i=0}try{n=t.toString().split(".")[1].length}catch(e){n=0}return a=Math.pow(10,Math.max(i,n)),(e*a+t*a)/a}function accSubtr(e,t){var i,n,a,o;try{i=e.toString().split(".")[1].length}catch(e){i=0}try{n=t.toString().split(".")[1].length}catch(e){n=0}return a=Math.pow(10,Math.max(i,n)),o=i>=n?i:n,((e.mul(a)-t.mul(a))/a).toFixed(o)}!function(e){e.fn.combo=function(t){if(0==this.length)return this;var i,n=arguments;return this.each(function(){var a=e(this).data("_combo");if("string"==typeof t){if(!a)return;"function"==typeof a[t]&&(n=Array.prototype.slice.call(n,1),i=a[t].apply(a,n))}else a||(a=new e.Combo(e(this),t),e(this).data("_combo",a))}),void 0===i?this:i},e.fn.getCombo=function(){return e.Combo.getCombo(this)},e.Combo=function(t,i){this.obj=t,this.opts=e.extend(!0,{},e.Combo.defaults,i),this.dataOpt=this.opts.data,this._selectedIndex=-1,this.addQuery=!0,this._disabled=void 0!==this.opts.disabled?!!this.opts.disabled:!!this.obj.attr("disabled"),e.extend(this,this.opts.callback),this._init()},e.Combo.getCombo=function(t){if(0!=(t=e(t)).length){if(1==t.length)return t.data("_combo");if(t.length>1){var i=[];return t.each(function(t){i.push(e(this).data("_combo"))}),i}}},e.Combo.prototype={constructor:e.Combo,_init:function(){var e=this.opts;"select"==this.obj[0].tagName.toLowerCase()&&(this.originSelect=this.obj,this.dataOpt=this._getDataFromSelect()),this._createCombo(),this.loadData(this.dataOpt,e.defaultSelected,e.defaultFlag),this._handleDisabled(this._disabled),this._bindEvent()},loadData:function(e,t,i){if(this.xhr&&this.xhr.abort(),this.empty(!1),this.dataOpt=e,this.mode=this._getRenderMode(),this.mode)if("local"==this.mode){this._formatData();var n=this.formattedData.slice(0,this.opts.maxFilter);this._populateList(n),this._setDefaultSelected(t,i)}else"remote"==this.mode&&this._loadAjaxData(t,i)},activate:function(){this.focus||this.input.focus(),this.wrap.addClass(this.opts.activeCls),this.active=!0},_blur:function(){this.active&&(this.collapse(),this.opts.editable&&this.opts.forceSelection&&(this.selectByText(this.input.val()),-1==this._selectedIndex&&this.input.val("")),this.wrap.removeClass(this.opts.activeCls),this.active=!1,"function"==typeof this.onBlur&&this.onBlur())},blur:function(){this.focus&&this.input.blur(),this._blur()},_bindEvent:function(){var t=this,i=this.opts,n="."+i.listItemCls;t.list.on("click",n,function(n){e(this).hasClass(i.selectedCls)||t.selectByItem(e(this)),t.collapse(),t.input.focus(),"function"==typeof i.callback.onListClick&&i.callback.onListClick.call(t)}).on("mouseover",n,function(t){e(this).addClass(i.hoverCls).siblings().removeClass(i.hoverCls)}).on("mouseleave",n,function(t){e(this).removeClass(i.hoverCls)}),t.input.on("focus",function(e){t.wrap.addClass(i.activeCls),t.focus=!0,t.active=!0,"function"==typeof t.onFocus&&t.onFocus()}).on("blur",function(e){t.focus=!1}),i.editable?t.input.on("click",function(e){}):t.input.on("click",function(e){t._onTriggerClick()}),t.trigger&&t.trigger.on("click",function(e){t._onTriggerClick()}),e(document).on("click",function(i){var n=i.target||i.srcElement;0==e(n).closest(t.wrap).length&&0==e(n).closest(t.listWrap).length&&t.blur()}),this.listWrap.on("click",function(e){e.stopPropagation()}),e(window).on("resize",function(){t._setListPosition()}),this._bindKeyEvent()},_bindKeyEvent:function(){var t=this,i=this.opts,n={backSpace:8,esc:27,f7:118,up:38,down:40,tab:9,enter:13,home:36,end:35,pageUp:33,pageDown:34,space:32};this.input.on("keydown",function(a){switch(a.keyCode){case n.tab:t._blur();break;case n.down:case n.up:if(t.isExpanded){r=a.keyCode==n.down?"next":"prev";t._setItemFocus(r)}else t._onTriggerClick();a.preventDefault();break;case n.enter:if(t.queryDelay&&window.clearTimeout(t.queryDelay),t.isExpanded)(s=t.list.find("."+i.hoverCls)).length>0&&(s.find("p").trigger("click"),t.selectByItem(s)),t.collapse();else{var o=e.trim(t.input.val());t.selectByText(o)}"function"==typeof i.callback.onEnter&&i.callback.onEnter(a);break;case n.home:case n.end:if(t.isExpanded){var s=a.keyCode==n.home?t.list.find("."+i.listItemCls).eq(0):t.list.find("."+i.listItemCls).filter(":last");t._scrollToItem(s),a.preventDefault()}break;case n.pageUp:case n.pageDown:if(t.isExpanded){var r=a.keyCode==n.pageUp?"up":"down";t._scrollPage(r),a.preventDefault()}}}).on("keyup",function(e){if(i.editable){var a=e.which,o=8==a||9==a||13==a||27==a||a>=16&&a<=20||a>=33&&a<=40||a>=44&&a<=46||a>=112&&a<=123||144==a||145==a,s=t.input.val();o&&a!=n.backSpace||t.doDelayQuery(s)}}),e(document).on("keydown",function(e){e.keyCode==n.esc&&t.collapse()})},distory:function(){},enable:function(){this._handleDisabled(!1)},disable:function(e){e=void 0===e||!!e,this._handleDisabled(e)},_handleDisabled:function(e){var t=this.opts;this._disabled=e,1==e?this.wrap.addClass(t.disabledCls):this.wrap.removeClass(t.disabledCls),this.input.attr("disabled",e)},_createCombo:function(){var t,i,n,a=this.opts,o=parseInt(this.opts.width);this.originSelect&&this.originSelect.hide(),"input"==this.obj[0].tagName.toLowerCase()?this.input=this.obj:(i=this.obj.find("."+a.inputCls),this.input=i.length>0?i:e('<input type="text" class="'+a.inputCls+'"/>')),this.input.attr({autocomplete:"off",readOnly:!a.editable}).css({cursor:a.editable?"":"default"}),(n=e(this.obj).find("."+a.triggerCls)).length>0?this.trigger=n:!1!==a.trigger&&(this.trigger=e('<span class="'+a.triggerCls+'"></span>')),(t=this.obj.hasClass(a.wrapCls)?this.obj:this.obj.find("."+a.wrapCls)).length>0?this.wrap=t.append(this.input,this.trigger):this.trigger&&(this.wrap=e('<span class="'+a.wrapCls+'"></span>').append(this.input,this.trigger),this.originSelect&&this.obj[0]==this.originSelect[0]||this.obj[0]==this.input[0]?this.obj.next().length>0?this.wrap.insertBefore(this.obj.next()):this.wrap.appendTo(this.obj.parent()):this.wrap.appendTo(this.obj)),this.wrap&&a.id&&this.wrap.attr("id",a.id),this.wrap||(this.wrap=this.input),this._setComboLayout(o),a.forGoodsCombo?(this.list=e("<div />").addClass(a.listCls).css({position:"relative",height:"300px",overflow:"auto",width:"861px",border:"1px solid #ccc"}),this.listWrap=e("<div />").addClass(a.listWrapCls).attr("id",a.listId).hide().append(this.list).css({position:"absolute",top:0,zIndex:a.zIndex,border:0})):(this.list=e("<div />").addClass(a.listCls).css({position:"relative",overflow:"auto"}),this.listWrap=e("<div />").addClass(a.listWrapCls).attr("id",a.listId).hide().append(this.list).css({position:"absolute",top:0,zIndex:a.zIndex})),a.extraListHtml&&(a.forGoodsCombo?e("<div />").addClass(a.extraListHtmlCls).append(a.extraListHtml).appendTo(this.listWrap).css({width:"856px",border:"#ccc 1px solid",borderTop:"none"}):e("<div />").addClass(a.extraListHtmlCls).append(a.extraListHtml).appendTo(this.listWrap)),a.listRenderToBody?(e.Combo.allListWrap||(e.Combo.allListWrap=e('<div id="COMBO_WRAP"/>').appendTo("body")),this.listWrap.appendTo(e.Combo.allListWrap)):this.wrap.after(this.listWrap)},_setListLayout:function(){var e,t,i=this.opts,n=parseInt(i.listHeight),a=0,o=this.trigger?this.trigger.outerWidth():0,s=parseInt(i.minListWidth),r=parseInt(i.maxListWidth);if(this.listWrap.width("auto"),this.list.height("auto"),this.listWrap.show(),this.isExpanded=!0,t=this.list.height(),!isNaN(n)&&n>=0&&(n=Math.min(n,t),this.list.height(n)),"auto"==i.listWidth||"auto"==i.width?(e=this.listWrap.outerWidth(),t<this.list.height()&&(e+=a=20)):(e=parseInt(i.listWidth),isNaN(e)&&(e=this.wrap.outerWidth())),"auto"==i.width){var l=this.listWrap.outerWidth()+Math.max(o,a);this._setComboLayout(l)}s=isNaN(s)?this.wrap.outerWidth():Math.max(s,this.wrap.outerWidth()),!isNaN(s)&&e<s&&(e=s),!isNaN(r)&&e>r&&(e=r),e-=this.listWrap.outerWidth()-this.listWrap.width(),this.listWrap.width(e),this.listWrap.hide(),this.isExpanded=!1},_setComboLayout:function(e){if(e){var t=this.opts,i=parseInt(t.maxWidth),n=parseInt(t.minWidth);!isNaN(i)&&e>i&&(e=i),!isNaN(n)&&e<n&&(e=n);var a;e-=this.wrap.outerWidth()-this.wrap.width(),this.wrap.width(e),this.wrap[0]!=this.input[0]&&(a=e-(this.trigger?this.trigger.outerWidth():0)-(this.input.outerWidth()-this.input.width()),this.input.width(a))}},_setListPosition:function(){if(this.isExpanded){this.opts;var t,i,n=e(window),a=this.wrap.offset().top,o=this.wrap.offset().left,s=n.height(),r=n.width(),l=n.scrollTop(),d=n.scrollLeft(),c=this.wrap.outerHeight(),h=this.wrap.outerWidth(),u=this.listWrap.outerHeight(),p=this.listWrap.outerWidth(),f=parseInt(this.listWrap.css("border-top-width"));t=a-l+c+u>s&&a>u?a-u+f:a+c-f,i=o-d+p>r?o+h-p:o,this.listWrap.css({top:t,left:i}),this.opts.forGoodsCombo&&this.list.css({height:"350px"})}},_getRenderMode:function(){var t,i=this.dataOpt;return e.isFunction(i)&&(i=i()),e.isArray(i)?(this.rawData=i,t="local"):"string"==typeof i&&(this.url=i,t="remote"),t},_loadAjaxData:function(t,i,n){var a=this,o=a.opts,s=o.ajaxOptions;"function"==typeof s&&(s=e.extend(!0,e.Combo.defaults.ajaxOptions,s()));var r=e("<div />").addClass(o.loadingCls).text(s.loadingText);a.list.append(r),a.list.empty(),a._setListLayout(),a._setListPosition(),a.xhr=e.ajax({url:a.url,data:s.data,type:s.type,dataType:s.dataType,timeout:s.timeout,success:function(o){r.remove(),e.isFunction(s.success)&&s.success(o),e.isFunction(s.formatData)&&(o=s.formatData(o)),o&&(a.rawData=o,a._selectedIndex=-1,a._formatData(),a._populateList(a.formattedData),""===t?(a.lastQuery=n,a.filterData=a.formattedData,a.expand()):a._setDefaultSelected(t,i),a.xhr=null,a.mode=a._getRenderMode())},error:function(t,i,n){r.remove(),e("<div />").addClass(o.tipsCls).text(s.errorText).appendTo(a.list),a.xhr=null}})},getDisabled:function(){return this._disabled},getValue:function(){return this._selectedIndex>-1?this.formattedData[this._selectedIndex].value:this.opts.forceSelection?"":this.input.val()},getText:function(){return this._selectedIndex>-1?this.formattedData[this._selectedIndex].text:this.opts.forceSelection?"":this.input.val()},getSelectedIndex:function(){return this._selectedIndex},getSelectedRow:function(){var e=this._selectedIndex,t=[],i=this.opts;if(i.emptyOptions&&t.push({name:"(空)",id:0}),i.addOptions&&(t.push(i.addOptions),t.push({name:i.addOptions.text,id:i.addOptions.value})),t=t.concat(this.rawData),e>-1)return t[e]},getDataRow:function(){return this.getSelectedRow()},getAllData:function(){return this.formattedData},getAllRawData:function(){return this.rawData},_setDefaultSelected:function(t,i){var n=this.opts;if("function"==typeof t&&(defaultSelected=defaultSelected.call(this,this.rawData)),isNaN(parseInt(t)))if(e.isArray(t))this.selectByKey(t[0],t[1],i);else if(this.originSelect){a=this.originSelect[0].selectedIndex;this._setSelected(a,i)}else n.autoSelect&&this._setSelected(0,i);else{var a=parseInt(t);this._setSelected(a,i)}},selectByIndex:function(e,t){this._setSelected(e,t)},selectByText:function(e,t){if(this.formattedData){for(var i=this.formattedData,n=-1,a=0,o=i.length;a<o;a++)if(i[a].text===e){n=a;break}this._setSelected(n,t)}},selectByValue:function(e,t){if(this.formattedData){for(var i=this.formattedData,n=-1,a=0,o=i.length;a<o;a++)if(i[a].value==e){n=a;break}this._setSelected(n,t)}},selectByKey:function(e,t,i){if(this.rawData){var n=this.opts,a=this.rawData,o=-1;if(n.addOptions||n.emptyOptions){for(var s=0,r=(a=this.formattedData).length;s<r;s++)if(a[s].value==t){o=s;break}}else for(var s=0,r=a.length;s<r;s++)if(a[s][e]==t){o=s;break}this._setSelected(o,i)}},selectByItem:function(e,t){if(this.opts.forGoodsCombo){if(!e||e.parent()[0]!=this.list[0])return;if(""==e.find("span:eq(2)").text())i=e.find("a:eq(0)").text()+" "+e.find("a:eq(1)").text();else i=e.find("a:eq(0)").text()+" "+e.find("a:eq(1)").text()+"_"+e.find("span:eq(2)").text();this.selectByText(i,t)}else{if(!e||e.parent()[0]!=this.list[0])return;var i=e.text();this.selectByText(i,t)}},_setSelected:function(e,t){var i=this.opts,e=parseInt(e),t=void 0===t||!!t;if(!isNaN(e))if(this.formattedData&&0!=this.formattedData.length){var n=this.formattedData.length;if((e<-1||e>=n)&&(e=-1),this._selectedIndex!=e){var a=-1==e?null:this.formattedData[e],o=-1==e?null:a.rawData,s=-1==e?"":a.text;this.list.find("."+i.listItemCls);t&&"function"==typeof this.beforeChange&&!this.beforeChange(o)||(i.editable&&-1==e&&this.focus||this.input.val(s),this._selectedIndex=e,t&&"function"==typeof this.onChange&&this.onChange(o),this.originSelect&&(this.originSelect[0].selectedIndex=e))}}else this._selectedIndex=-1},removeSelected:function(e){this.input.val(""),this._setSelected(-1,e)},_triggerCallback:function(e,t){},_getDataFromSelect:function(){var t=this.opts,i=[];return e.each(this.originSelect.find("option"),function(n){var a=e(this),o={};o[t.text]=a.text(),o[t.value]=a.attr("value"),i.push(o)}),i},_formatData:function(){if(e.isArray(this.rawData)){var t=this,i=t.opts;t.formattedData=[],i.emptyOptions&&t.formattedData.push({text:"(空)",value:0}),i.addOptions&&t.formattedData.push(i.addOptions),e.each(this.rawData,function(n,a){var o={};o.text=e.isFunction(i.formatText)?i.formatText(a):a[i.text],o.value=e.isFunction(i.formatValue)?i.formatValue(a):a[i.value],o.rawData=a,t.formattedData.push(o)}),t.formattedLen=t.formattedData.length}},_filter:function(t){t=void 0===t?"":t,this.input.val()!=this.getText()&&this.selectByText(this.input.val());var i=this.opts,n=this;i.maxFilter;if(this.opts.cache||("local"==this.mode&&e.isFunction(this.dataOpt)&&(this.rawData=this.dataOpt()),this._formatData()),e.isArray(this.formattedData)){if(""==t)i.editable?this.filterData=this.formattedData.slice(0,i.maxFilter):this.filterData=this.formattedData;else{this.filterData=[];var a=[];e.each(n.formattedData,function(o,s){var r=s.text;if(e.isFunction(i.customMatch)){if(!i.customMatch(s,t))return}else{var l=i.caseSensitive?"":"i",d=new RegExp(t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),l);if(-1==r.search(d))return}if(n.filterData.push(s),a.push({i:o,val:s.value}),n.filterData.length==i.maxFilter)return!1})}for(var o={},s=[],r=0,l=this.filterData.length;r<l;r++){var d=this.filterData[r];o[d.value]||(o[d.value]=!0,s.push(d))}this.filterData=s,s=[],o={},e.isFunction(this.incrementalSearch)&&100===n.formattedLen&&n.filterData.length<i.maxFilter?!0===n.addQuery&&this.incrementalSearch(a,function(){this._formatData(),this.filterData=this.formattedData,this.lastQuery=t,this.list.empty(),this._populateList(this.filterData),this.expand()}):(this.lastQuery=t,this.list.empty(),this._populateList(this.filterData),this.expand())}},doDelayQuery:function(e){var t=this,i=t.opts,n=parseInt(i.queryDelay);isNaN(n)&&(n=0),t.queryDelay&&window.clearTimeout(t.queryDelay),t.queryDelay=window.setTimeout(function(){t.doQuery(e)},n)},doQuery:function(e){"local"==this.mode||"remote"==this.mode&&this.opts.loadOnce?this._filter(e):this._loadAjaxData("",!1,e)},_populateList:function(t){if(t){var i=this,n=i.opts;if(0==t.length)n.forceSelection&&(e("<div />").addClass(n.tipsCls).html(n.noDataText).appendTo(i.list),this._setListLayout());else{if(n.forGoodsCombo)if(Public.getDefaultPage().SYSTEM.enableAssistingProp)for(var a=-1,o=t.length;a<o;a++){var s="";if(-1==a){var r='<span style="width: 150px;text-align:center">商品编号</span><span style="width: 290px;text-align:center">商品名称</span><span style="width: 200px;text-align:center">规格型号</span><span style="width: 100px;text-align:center">辅助属性</span><span style="width: 60px;text-align:center">基本单位</span>',l=e("<div />").attr({class:n.listItemCls+(a==this._selectedIndex?" "+n.selectedCls:"")}).css({"border-bottom":"1px solid #ccc","border-right":"1px solid #ccc","border-left":"1px solid #ccc",padding:"0px","line-height":"0px"});n.disStrict,l.html(r).appendTo(i.list)}else{var d=(m=t[a].rawData).number||"",c=m.name||"",h=m.spec||"",u=m.unitName||"";m.remark;if(m.invSkus&&m.invSkus.length>0)for(var p=m.invSkus,f=0;f<p.length;f++){m.invSkus[f].skuName&&(s=p[f].skuName);var r="<p onclick=invorderFun("+f+')><span style="width: 150px"><a title="'+d+'">'+d+'</a></span><span style="width: 290px"><a title="'+c+'">'+c+'</a></span><span style="width: 200px">'+h+'</span><span style="width: 100px" invorder="'+f+'" class="skustring">'+(s||" ")+'</span><span style="width: 60px;border-right:0px">'+u+"</span></p>",g=(b=m).text,v=b.value,l=e("<div />").attr({class:n.listItemCls+(a==this._selectedIndex?" "+n.selectedCls:""),"data-value":v}).css({"border-bottom":"1px solid #ccc","border-right":"1px solid #ccc","border-left":"1px solid #ccc",padding:"0px","line-height":"0px"});n.disStrict,l.html(r).appendTo(i.list),0==a&&0==f&&l.addClass("on")}else{var r='<p><span style="width: 150px"><a title="'+d+'">'+d+'</a></span><span style="width: 290px"><a title="'+c+'">'+c+'</a></span><span style="width: 200px">'+h+'</span><span style="width: 100px">'+(s||" ")+'</span><span style="width: 60px;border-right:0px">'+u+"</span></p>",g=(b=m).text,v=b.value,l=e("<div />").attr({class:n.listItemCls+(a==this._selectedIndex?" "+n.selectedCls:""),"data-value":v}).css({"border-bottom":"1px solid #ccc","border-right":"1px solid #ccc","border-left":"1px solid #ccc",padding:"0px","line-height":"0px"});n.disStrict,l.html(r).appendTo(i.list),0==a&&l.addClass("on")}}}else for(var a=-1,o=t.length;a<o;a++)if(-1==a){var r='<span style="width: 200px;text-align:center">商品编号</span><span style="width: 320px;text-align:center">商品名称</span><span style="width: 200px;text-align:center">规格型号</span><span style="width: 70px;text-align:center;border-right:0px">基本单位</span>',l=e("<div />").attr({class:n.listItemCls+(a==this._selectedIndex?" "+n.selectedCls:"")}).css({"border-bottom":"1px solid #ccc","border-right":"1px solid #ccc","border-left":"1px solid #ccc",padding:"0px","line-height":"0px"});n.disStrict,l.html(r).appendTo(i.list),0==a&&l.addClass("on")}else{var m=t[a].rawData,d=m.number||"",c=m.name||"",h=m.spec||"",u=m.unitName||"",r=(m.remark,'<p><span style="width: 200px"><a title="'+d+'">'+d+'</a></span><span style="width: 320px"><a title="'+c+'">'+c+'</a></span><span style="width: 200px">'+h+'</span><span style="width: 70px;border-right:0px">'+u+"</span></p>"),g=(b=m).text,v=b.value,l=e("<div />").attr({class:n.listItemCls+(a==this._selectedIndex?" "+n.selectedCls:""),"data-value":v}).css({"border-bottom":"1px solid #ccc","border-right":"1px solid #ccc","border-left":"1px solid #ccc",padding:"0px","line-height":"0px"});n.disStrict,l.html(r).appendTo(i.list),0==a&&l.addClass("on")}else for(var a=0,o=t.length;a<o;a++){var b=t[a],g=b.text,v=b.value,l=e("<div />").attr({class:n.listItemCls+(a==this._selectedIndex?" "+n.selectedCls:""),"data-value":v});n.disStrict?l.html(g).appendTo(i.list):l.text(g).appendTo(i.list)}this._setListLayout()}}},expand:function(){var t=this.opts;if(this.active&&!this.isExpanded&&(0!=this.filterData.length||t.noDataText||t.extraListHtmlCls)){this.isExpanded=!0,this.listWrap.show(),this._setListPosition(),e.isFunction(this.onExpand)&&this.onExpand();var i=this.list.find("."+t.listItemCls);if(0!=i.length){var n=i.filter("."+t.selectedCls);0==n.length&&(n=i.eq(0),t.autoSelectFirst&&n.addClass(t.hoverCls)),this._scrollToItem(n)}}else this.listWrap.hide()},collapse:function(){if(this.isExpanded){var t=this.opts;this.listWrap.hide(),this.isExpanded=!1,this.listItems&&this.listItems.removeClass(t.hoverCls),e.isFunction(this.onCollapse)&&this.onCollapse()}},_onTriggerClick:function(){this._disabled||(this.active=!0,this.input.focus(),this.isExpanded?this.collapse():this._filter())},_scrollToItem:function(e){if(e&&0!=e.length){var t=this.list.scrollTop(),i=t+e.position().top,n=t+this.list.height(),a=i+e.outerHeight();(i<t||a>n)&&this.list.scrollTop(i)}},_scrollPage:function(e){var t,i=this.list.scrollTop(),n=this.list.height();"up"==e?t=i-n:"down"==e&&(t=i+n),this.list.scrollTop(t)},_setItemFocus:function(e){var t,i,n=this.opts,a=this.list.find("."+n.listItemCls);if(0!=a.length){var o=a.filter("."+n.hoverCls).eq(0);0==o.length&&(o=a.filter("."+n.selectedCls).eq(0)),0==o.length?t=0:(t=a.index(o),t="next"==e?t==a.length-1?0:t+1:0==t?a.length-1:t-1),i=a.eq(t),a.removeClass(n.hoverCls),i.addClass(n.hoverCls),this._scrollToItem(i)}},empty:function(e){this._setSelected(-1,!1),this.input.val(""),this.list.empty(),this.rawData=null,this.formattedData=null},setEdit:function(){}},e.Combo.defaults={data:null,text:"text",value:"value",formatText:null,formatValue:null,defaultSelected:void 0,defaultFlag:!0,autoSelect:!0,disabled:void 0,editable:!1,caseSensitive:!1,forceSelection:!0,cache:!0,queryDelay:100,maxFilter:200,minChars:0,customMatch:null,addQuery:"",noDataText:"没有匹配的选项",autoSelectFirst:!0,width:void 0,minWidth:void 0,maxWidth:void 0,listWidth:void 0,listHeight:150,maxListWidth:void 0,maxListWidth:void 0,zIndex:1e3,listRenderToBody:!0,extraListHtml:void 0,disStrict:!1,ajaxOptions:{type:"post",dataType:"json",data:null,queryParam:"query",timeout:1e4,formatData:null,loadingText:"Loading...",success:null,error:null,errorText:"数据加载失败"},loadOnce:!0,id:void 0,listId:void 0,wrapCls:"ui-combo-wrap",focusCls:"ui-combo-focus",disabledCls:"ui-combo-disabled",activeCls:"ui-combo-active",inputCls:"input-txt",triggerCls:"trigger",listWrapCls:"ui-droplist-wrap",listCls:"droplist",listItemCls:"list-item",selectedCls:"selected",hoverCls:"on",loadingCls:"loading",tipsCls:"tips",extraListHtmlCls:"extra-list-ctn",callback:{onFocus:null,onBlur:null,beforeChange:null,onChange:null,onExpand:null,onCollapse:null,onEnter:null,onListClick:null}}}(jQuery),function(e){e.extend(e.fn,{validate:function(t){if(this.length){var i=e.data(this[0],"validator");return i||("undefined"!=typeof Worker&&this.attr("novalidate","novalidate"),i=new e.validator(t,this[0]),e.data(this[0],"validator",i),i.settings.onsubmit&&(this.validateDelegate(":submit","click",function(t){i.settings.submitHandler&&(i.submitButton=t.target),e(t.target).hasClass("cancel")&&(i.cancelSubmit=!0),void 0!==e(t.target).attr("formnovalidate")&&(i.cancelSubmit=!0)}),this.submit(function(t){function n(){var n;return!i.settings.submitHandler||(i.submitButton&&(n=e("<input type='hidden'/>").attr("name",i.submitButton.name).val(e(i.submitButton).val()).appendTo(i.currentForm)),i.settings.submitHandler.call(i,i.currentForm,t),i.submitButton&&n.remove(),!1)}return i.settings.debug&&t.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,n()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):n():(i.focusInvalid(),!1)})),i)}t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.")},valid:function(){if(e(this[0]).is("form"))return this.validate().form();var t=!0,i=e(this[0].form).validate();return this.each(function(){t=t&&i.element(this)}),t},removeAttrs:function(t){var i={},n=this;return e.each(t.split(/\s/),function(e,t){i[t]=n.attr(t),n.removeAttr(t)}),i},rules:function(t,i){var n=this[0];if(t){var a=e.data(n.form,"validator").settings,o=a.rules,s=e.validator.staticRules(n);switch(t){case"add":e.extend(s,e.validator.normalizeRule(i)),delete s.messages,o[n.name]=s,i.messages&&(a.messages[n.name]=e.extend(a.messages[n.name],i.messages));break;case"remove":if(!i)return delete o[n.name],s;var r={};return e.each(i.split(/\s/),function(e,t){r[t]=s[t],delete s[t]}),r}}var l=e.validator.normalizeRules(e.extend({},e.validator.classRules(n),e.validator.attributeRules(n),e.validator.dataRules(n),e.validator.staticRules(n)),n);if(l.required){var d=l.required;delete l.required,l=e.extend({required:d},l)}return l}}),e.extend(e.expr[":"],{blank:function(t){return!e.trim(""+e(t).val())},filled:function(t){return!!e.trim(""+e(t).val())},unchecked:function(t){return!e(t).prop("checked")}}),e.validator=function(t,i){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=i,this.init()},e.validator.format=function(t,i){return 1===arguments.length?function(){var i=e.makeArray(arguments);return i.unshift(t),e.validator.format.apply(this,i)}:(arguments.length>2&&i.constructor!==Array&&(i=e.makeArray(arguments).slice(1)),i.constructor!==Array&&(i=[i]),e.each(i,function(e,i){t=t.replace(RegExp("\\{"+e+"\\}","g"),function(){return i})}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(e)).hide())},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(e,t){(9!==t.which||""!==this.elementValue(e))&&(e.name in this.submitted||e===this.lastElement)&&this.element(e)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,i,n){"radio"===t.type?this.findByName(t.name).addClass(i).removeClass(n):e(t).addClass(i).removeClass(n)},unhighlight:function(t,i,n){"radio"===t.type?this.findByName(t.name).removeClass(i).addClass(n):e(t).removeClass(i).addClass(n)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:e.validator.format("Please enter no more than {0} characters."),minlength:e.validator.format("Please enter at least {0} characters."),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long."),range:e.validator.format("Please enter a value between {0} and {1}."),max:e.validator.format("Please enter a value less than or equal to {0}."),min:e.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function t(t){var i=e.data(this[0].form,"validator"),n="on"+t.type.replace(/^validate/,"");i.settings[n]&&i.settings[n].call(i,this[0],t)}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var i=this.groups={};e.each(this.settings.groups,function(t,n){"string"==typeof n&&(n=n.split(/\s/)),e.each(n,function(e,n){i[n]=t})});var n=this.settings.rules;e.each(n,function(t,i){n[t]=e.validator.normalizeRule(i)}),e(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",t).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",t),this.settings.invalidHandler&&e(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){t=this.validationTargetFor(this.clean(t)),this.lastElement=t,this.prepareElement(t),this.currentElements=e(t);var i=!1!==this.check(t);return i?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),i},showErrors:function(t){if(t){e.extend(this.errorMap,t),this.errorList=[];for(var i in t)this.errorList.push({message:t[i],element:this.findByName(i)[0]});this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t=0;for(var i in e)t++;return t},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var t=this.lastActive;return t&&1===e.grep(this.errorList,function(e){return e.element.name===t.name}).length&&t},elements:function(){var t=this,i={};return e(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),!(this.name in i||!t.objectLength(e(this).rules()))&&(i[this.name]=!0,!0)})},clean:function(t){return e(t)[0]},errors:function(){var t=this.settings.errorClass.replace(" ",".");return e(this.settings.errorElement+"."+t,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([]),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(t){var i=e(t).attr("type"),n=e(t).val();return"radio"===i||"checkbox"===i?e("input[name='"+e(t).attr("name")+"']:checked").val():"string"==typeof n?n.replace(/\r/g,""):n},check:function(t){t=this.validationTargetFor(this.clean(t));var i,n=e(t).rules(),a=!1,o=this.elementValue(t);for(var s in n){var r={method:s,parameters:n[s]};try{if("dependency-mismatch"===(i=e.validator.methods[s].call(this,o,t,r.parameters))){a=!0;continue}if(a=!1,"pending"===i)return void(this.toHide=this.toHide.not(this.errorsFor(t)));if(!i)return this.formatAndAdd(t,r),!1}catch(e){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+r.method+"' method.",e),e}}return a?void 0:(this.objectLength(n)&&this.successList.push(t),!0)},customDataMessage:function(t,i){return e(t).data("msg-"+i.toLowerCase())||t.attributes&&e(t).attr("data-msg-"+i.toLowerCase())},customMessage:function(e,t){var i=this.settings.messages[e];return i&&(i.constructor===String?i:i[t])},findDefined:function(){for(var e=0;arguments.length>e;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(t,i){return this.findDefined(this.customMessage(t.name,i),this.customDataMessage(t,i),!this.settings.ignoreTitle&&t.title||void 0,e.validator.messages[i],"<strong>Warning: No message defined for "+t.name+"</strong>")},formatAndAdd:function(t,i){var n=this.defaultMessage(t,i.method),a=/\$?\{(\d+)\}/g;"function"==typeof n?n=n.call(this,i.parameters,t):a.test(n)&&(n=e.validator.format(n.replace(a,"{$1}"),i.parameters)),this.errorList.push({message:n,element:t}),this.errorMap[t.name]=n,this.submitted[t.name]=n},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){var e,t;for(e=0;this.errorList[e];e++){var i=this.errorList[e];this.settings.highlight&&this.settings.highlight.call(this,i.element,this.settings.errorClass,this.settings.validClass),this.showLabel(i.element,i.message)}if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,i){var n=this.errorsFor(t);n.length?(n.removeClass(this.settings.validClass).addClass(this.settings.errorClass),n.html(i)):(n=e("<"+this.settings.errorElement+">").attr("for",this.idOrName(t)).addClass(this.settings.errorClass).html(i||""),this.settings.wrapper&&(n=n.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(n).length||(this.settings.errorPlacement?this.settings.errorPlacement(n,e(t)):n.insertAfter(t))),!i&&this.settings.success&&(n.text(""),"string"==typeof this.settings.success?n.addClass(this.settings.success):this.settings.success(n,t)),this.toShow=this.toShow.add(n)},errorsFor:function(t){var i=this.idOrName(t);return this.errors().filter(function(){return e(this).attr("for")===i})},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(e){return this.checkable(e)&&(e=this.findByName(e.name).not(this.settings.ignore)[0]),e},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){return e(this.currentForm).find("[name='"+t+"']")},getLength:function(t,i){switch(i.nodeName.toLowerCase()){case"select":return e("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return t.length},depend:function(e,t){return!this.dependTypes[typeof e]||this.dependTypes[typeof e](e,t)},dependTypes:{boolean:function(e){return e},string:function(t,i){return!!e(t,i.form).length},function:function(e,t){return e(t)}},optional:function(t){var i=this.elementValue(t);return!e.validator.methods.required.call(this,i,t)&&"dependency-mismatch"},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,this.pending[e.name]=!0)},stopRequest:function(t,i){0>--this.pendingRequest&&(this.pendingRequest=0),delete this.pending[t.name],i&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!i&&0===this.pendingRequest&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,i){t.constructor===String?this.classRuleSettings[t]=i:e.extend(this.classRuleSettings,t)},classRules:function(t){var i={},n=e(t).attr("class");return n&&e.each(n.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(i,e.validator.classRuleSettings[this])}),i},attributeRules:function(t){var i={},n=e(t),a=n[0].getAttribute("type");for(var o in e.validator.methods){var s;"required"===o?(""===(s=n.get(0).getAttribute(o))&&(s=!0),s=!!s):s=n.attr(o),/min|max/.test(o)&&(null===a||/number|range|text/.test(a))&&(s=Number(s)),s?i[o]=s:a===o&&"range"!==a&&(i[o]=!0)}return i.maxlength&&/-1|2147483647|524288/.test(i.maxlength)&&delete i.maxlength,i},dataRules:function(t){var i,n,a={},o=e(t);for(i in e.validator.methods)void 0!==(n=o.data("rule-"+i.toLowerCase()))&&(a[i]=n);return a},staticRules:function(t){var i={},n=e.data(t.form,"validator");return n.settings.rules&&(i=e.validator.normalizeRule(n.settings.rules[t.name])||{}),i},normalizeRules:function(t,i){return e.each(t,function(n,a){if(!1!==a){if(a.param||a.depends){var o=!0;switch(typeof a.depends){case"string":o=!!e(a.depends,i.form).length;break;case"function":o=a.depends.call(i,i)}o?t[n]=void 0===a.param||a.param:delete t[n]}}else delete t[n]}),e.each(t,function(n,a){t[n]=e.isFunction(a)?a(i):a}),e.each(["minlength","maxlength"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength","range"],function(){var i;t[this]&&(e.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:"string"==typeof t[this]&&(i=t[this].split(/[\s,]+/),t[this]=[Number(i[0]),Number(i[1])]))}),e.validator.autoCreateRanges&&(t.min&&t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),t.minlength&&t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if("string"==typeof t){var i={};e.each(t.split(/\s/),function(){i[this]=!0}),t=i}return t},addMethod:function(t,i,n){e.validator.methods[t]=i,e.validator.messages[t]=void 0!==n?n:e.validator.messages[t],3>i.length&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,i,n){if(!this.depend(n,i))return"dependency-mismatch";if("select"===i.nodeName.toLowerCase()){var a=e(i).val();return a&&a.length>0}return this.checkable(i)?this.getLength(t,i)>0:e.trim(t).length>0},email:function(e,t){return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},url:function(e,t){return this.optional(t)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(""+new Date(e))},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(e)},number:function(e,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},creditcard:function(e,t){if(this.optional(t))return"dependency-mismatch";if(/[^0-9 \-]+/.test(e))return!1;for(var i=0,n=0,a=!1,o=(e=e.replace(/\D/g,"")).length-1;o>=0;o--){var s=e.charAt(o);n=parseInt(s,10),a&&(n*=2)>9&&(n-=9),i+=n,a=!a}return 0==i%10},minlength:function(t,i,n){var a=e.isArray(t)?t.length:this.getLength(e.trim(t),i);return this.optional(i)||a>=n},maxlength:function(t,i,n){var a=e.isArray(t)?t.length:this.getLength(e.trim(t),i);return this.optional(i)||n>=a},rangelength:function(t,i,n){var a=e.isArray(t)?t.length:this.getLength(e.trim(t),i);return this.optional(i)||a>=n[0]&&n[1]>=a},min:function(e,t,i){return this.optional(t)||e>=i},max:function(e,t,i){return this.optional(t)||i>=e},range:function(e,t,i){return this.optional(t)||e>=i[0]&&i[1]>=e},equalTo:function(t,i,n){var a=e(n);return this.settings.onfocusout&&a.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){e(i).valid()}),t===a.val()},remote:function(t,i,n){if(this.optional(i))return"dependency-mismatch";var a=this.previousValue(i);if(this.settings.messages[i.name]||(this.settings.messages[i.name]={}),a.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=a.message,n="string"==typeof n&&{url:n}||n,a.old===t)return a.valid;a.old=t;var o=this;this.startRequest(i);var s={};return s[i.name]=t,e.ajax(e.extend(!0,{url:n,mode:"abort",port:"validate"+i.name,dataType:"json",data:s,success:function(n){o.settings.messages[i.name].remote=a.originalMessage;var s=!0===n||"true"===n;if(s){var r=o.formSubmitted;o.prepareElement(i),o.formSubmitted=r,o.successList.push(i),delete o.invalid[i.name],o.showErrors()}else{var l={},d=n||o.defaultMessage(i,"remote");l[i.name]=a.message=e.isFunction(d)?d(t):d,o.invalid[i.name]=!0,o.showErrors(l)}a.valid=s,o.stopRequest(i,s)}},n)),"pending"}}}),e.format=e.validator.format}(jQuery),function(e){var t={};if(e.ajaxPrefilter)e.ajaxPrefilter(function(e,i,n){var a=e.port;"abort"===e.mode&&(t[a]&&t[a].abort(),t[a]=n)});else{var i=e.ajax;e.ajax=function(n){var a=("mode"in n?n:e.ajaxSettings).mode,o=("port"in n?n:e.ajaxSettings).port;return"abort"===a?(t[o]&&t[o].abort(),t[o]=i.apply(this,arguments),t[o]):i.apply(this,arguments)}}}(jQuery),function(e){e.extend(e.fn,{validateDelegate:function(t,i,n){return this.bind(i,function(i){var a=e(i.target);return a.is(t)?n.apply(a,arguments):void 0})}})}(jQuery),function(e){e.fn.powerFloat=function(n){return e(this).each(function(){var a,o=e.extend({},i,n||{}),s=function(e,i){t.target&&"none"!==t.target.css("display")&&t.targetHide(),t.s=e,t.trigger=i};switch(o.eventType){case"hover":e(this).hover(function(){t.timerHold&&(t.flagDisplay=!0);var i=parseInt(o.showDelay,10);s(o,e(this)),i?(a&&clearTimeout(a),a=setTimeout(function(){t.targetGet.call(t)},i)):t.targetGet()},function(){a&&clearTimeout(a),t.timerHold&&clearTimeout(t.timerHold),t.flagDisplay=!1,t.targetHold()}),o.hoverFollow&&e(this).mousemove(function(e){return t.cacheData.left=e.pageX,t.cacheData.top=e.pageY,t.targetGet.call(t),!1});break;case"click":e(this).click(function(i){t.display&&t.trigger&&i.target===t.trigger.get(0)?(t.flagDisplay=!1,t.displayDetect()):(s(o,e(this)),t.targetGet(),e(document).data("mouseupBind")||e(document).bind("mouseup",function(i){var n=!1;if(t.trigger){var a=t.target.attr("id");a||(a="R_"+Math.random(),t.target.attr("id",a)),e(i.target).parents().each(function(){e(this).attr("id")===a&&(n=!0)}),"click"===o.eventType&&t.display&&i.target!=t.trigger.get(0)&&!n&&(t.flagDisplay=!1,t.displayDetect())}return!1}).data("mouseupBind",!0))});break;case"focus":e(this).focus(function(){var i=e(this);setTimeout(function(){s(o,i),t.targetGet()},200)}).blur(function(){t.flagDisplay=!1,setTimeout(function(){t.displayDetect()},190)});break;default:s(o,e(this)),t.targetGet(),e(document).unbind("mouseup").data("mouseupBind",!1)}})};var t={targetGet:function(){if(!this.trigger)return this;var i=this.trigger.attr(this.s.targetAttr),n="function"==typeof this.s.target?this.s.target.call(this.trigger):this.s.target;switch(this.s.targetMode){case"common":if(n?"object"===(c=typeof n)?n.size()&&(t.target=n.eq(0)):"string"===c&&e(n).size()&&(t.target=e(n).eq(0)):i&&e("#"+i).size()&&(t.target=e("#"+i)),!t.target)return this;t.targetShow();break;case"ajax":var a=n||i;if(this.targetProtect=!1,!a)return;t.cacheData[a]||t.loading();var o=new Image;o.onload=function(){var i=o.width,n=o.height,s=e(window).width(),r=e(window).height(),l=i/n;l>s/r?i>s/2&&(n=(i=s/2)/l):n>r/2&&(i=(n=r/2)*l);var d='<img class="float_ajax_image" src="'+a+'" width="'+i+'" height = "'+n+'" />';t.cacheData[a]=!0,t.target=e(d),t.targetShow()},o.onerror=function(){/(\.jpg|\.png|\.gif|\.bmp|\.jpeg)$/i.test(a)?(t.target=e('<div class="float_ajax_error">图片加载失败。</div>'),t.targetShow()):e.ajax({url:a,success:function(i){"string"==typeof i&&(t.cacheData[a]=!0,t.target=e('<div class="float_ajax_data">'+i+"</div>"),t.targetShow())},error:function(){t.target=e('<div class="float_ajax_error">数据没有加载成功。</div>'),t.targetShow()}})},o.src=a;break;case"list":var s,r='<ul class="float_list_ul">';e.isArray(n)&&(s=n.length)?e.each(n,function(e,t){var i,n,a="",o="";0===e&&(o=' class="float_list_li_first"'),e===s-1&&(o=' class="float_list_li_last"'),"object"==typeof t&&(i=t.text.toString())?a=(n=t.href||"javascript:")?'<a href="'+n+'" class="float_list_a">'+i+"</a>":i:"string"==typeof t&&t&&(a=t),a&&(r+="<li"+o+">"+a+"</li>")}):r+='<li class="float_list_null">列表无数据。</li>',r+="</ul>",t.target=e(r),this.targetProtect=!1,t.targetShow();break;case"remind":var l=n||i;this.targetProtect=!1,"string"==typeof l&&(t.target=e("<span>"+l+"</span>"),t.targetShow());break;default:var d=n||i,c=typeof d;d&&("string"===c?(/^.[^:#\[\.,]*$/.test(d)?e(d).size()?(t.target=e(d).eq(0),this.targetProtect=!0):e("#"+d).size()?(t.target=e("#"+d).eq(0),this.targetProtect=!0):(t.target=e("<div>"+d+"</div>"),this.targetProtect=!1):(t.target=e("<div>"+d+"</div>"),this.targetProtect=!1),t.targetShow()):"object"===c&&!e.isArray(d)&&d.size()&&(t.target=d.eq(0),this.targetProtect=!0,t.targetShow()))}return this},container:function(){var i=this.s.container,n=this.s.targetMode||"mode";return this.s.sharpAngle="ajax"===n||"remind"===n,this.s.reverseSharp&&(this.s.sharpAngle=!this.s.sharpAngle),"common"!==n&&(null===i&&(i="plugin"),"plugin"===i&&(e("#floatBox_"+n).size()||e('<div id="floatBox_'+n+'" class="float_'+n+'_box"></div>').appendTo(e("body")).hide(),i=e("#floatBox_"+n)),i&&"string"!=typeof i&&i.size()&&(this.targetProtect&&t.target.show().css("position","static"),t.target=i.empty().append(t.target))),this},setWidth:function(){var e=this.s.width;return"auto"===e?this.target.get(0).style.width&&this.target.css("width","auto"):"inherit"===e?this.target.width(this.trigger.width()):this.target.css("width",e),this},position:function(){if(!this.trigger||!this.target)return this;var i,n,a,o,s,r,l,d=0,c=0,h=0,u=0,p=this.target.data("height"),f=this.target.data("width"),g=e(window).scrollTop(),v=parseInt(this.s.offsets.x,10)||0,m=parseInt(this.s.offsets.y,10)||0,b=this.cacheData;p||(p=this.target.outerHeight(),this.s.hoverFollow&&this.target.data("height",p)),f||(f=this.target.outerWidth(),this.s.hoverFollow&&this.target.data("width",f)),i=this.trigger.offset(),d=this.trigger.outerHeight(),c=this.trigger.outerWidth(),n=i.left,a=i.top;var y=function(){n<0?n=0:n+d>e(window).width()&&(n=e(window).width()-c)},N=function(){a<0?a=0:a+d>e(document).height()&&(a=e(document).height()-d)};this.s.hoverFollow&&b.left&&b.top&&("x"===this.s.hoverFollow?(n=b.left,y()):"y"===this.s.hoverFollow?(a=b.top,N()):(n=b.left,a=b.top,y(),N()));var C,k=["4-1","1-4","5-7","2-3","2-1","6-8","3-4","4-3","8-6","1-2","7-5","3-2"],w=this.s.position,T=!1;e.each(k,function(e,t){t!==w||(T=!0)}),T||(w="4-1");var x=function(e){var t="bottom";switch(e){case"1-4":case"5-7":case"2-3":t="top";break;case"2-1":case"6-8":case"3-4":t="right";break;case"1-2":case"8-6":case"4-3":t="left";break;case"4-1":case"7-5":case"3-2":t="bottom"}return t},D=function(e){return"5-7"===e||"6-8"===e||"8-6"===e||"7-5"===e},_=function(i){var o=0,s=0,r=!(!t.s.sharpAngle||!t.corner);if("right"===i){if(s=n+c+f+v,r&&(s+=t.corner.width()),s>e(window).width())return!1}else if("bottom"===i){if(o=a+d+p+m,r&&(o+=t.corner.height()),o>g+e(window).height())return!1}else if("top"===i){if(o=p+m,r&&(o+=t.corner.height()),o>a-g)return!1}else if("left"===i&&(s=f+v,r&&(s+=t.corner.width()),s>n))return!1;return!0};C=x(w),this.s.sharpAngle&&this.createSharp(C),this.s.edgeAdjust&&(_(C)?function(){if(!D(w)){var e,t={top:{right:"2-3",left:"1-4"},right:{top:"2-1",bottom:"3-4"},bottom:{right:"3-2",left:"4-1"},left:{top:"1-2",bottom:"4-3"}}[C];if(t)for(e in t)_(e)||(w=t[e])}}():function(){if(D(w))w={"5-7":"7-5","7-5":"5-7","6-8":"8-6","8-6":"6-8"}[w];else{var e={top:{left:"3-2",right:"4-1"},right:{bottom:"1-2",top:"4-3"},bottom:{left:"2-3",right:"1-4"},left:{bottom:"2-1",top:"3-4"}}[C],t=[];for(name in e)t.push(name);w=_(t[0])||!_(t[1])?e[t[0]]:e[t[1]]}}());var E=x(w),I=w.split("-")[0];if(this.s.sharpAngle&&(this.createSharp(E),h=this.corner.width(),u=this.corner.height()),this.s.hoverFollow)"x"===this.s.hoverFollow?(o=n+v,o="1"===I||"8"===I||"4"===I?n-(f-c)/2+v:n-(f-c)+v,"1"===I||"5"===I||"2"===I?(s=a-m-p-u,l=a-u-m-1):(s=a+d+m+u,l=a+d+m+1),r=i.left-(h-c)/2):"y"===this.s.hoverFollow?(s="1"===I||"5"===I||"2"===I?a-(p-d)/2+m:a-(p-d)+m,"1"===I||"8"===I||"4"===I?(o=n-f-v-h,r=n-h-v-1):(o=n+c-v+h,r=n+c+v+1),l=i.top-(u-d)/2):(o=n+v,s=a+m);else switch(E){case"top":s=a-m-p-u,o="1"==I?n-v:"5"===I?n-(f-c)/2-v:n-(f-c)-v,l=a-u-m-1,r=n-(h-c)/2;break;case"right":o=n+c+v+h,s="2"==I?a+m:"6"===I?a-(p-d)/2+m:a-(p-d)+m,r=n+c+v+1,l=a-(u-d)/2;break;case"bottom":s=a+d+m+u,o="4"==I?n+v:"7"===I?n-(f-c)/2+v:n-(f-c)+v,l=a+d+m+1,r=n-(h-c)/2;break;case"left":o=n-f-v-h,s="2"==I?a-m:"6"===I?a-(f-c)/2-m:a-(p-d)-m,r=o+h,l=a-(f-h)/2}return u&&h&&this.corner&&this.corner.css({left:r,top:l,zIndex:this.s.zIndex+1}),this.target.css({position:"absolute",left:o-30,top:s-21,zIndex:this.s.zIndex}),this},createSharp:function(t){var i,n,a="",o="",s={left:"right",right:"left",bottom:"top",top:"bottom"}[t]||"top";this.target&&(i=this.target.css("background-color"),parseInt(this.target.css("border-"+s+"-width"))>0&&(n=this.target.css("border-"+s+"-color")),a=n&&"transparent"!==n?'style="color:'+n+';"':'style="display:none;"',o=i&&"transparent"!==i?'style="color:'+i+';"':'style="display:none;"');var r='<div id="floatCorner_'+t+'" class="float_corner float_corner_'+t+'"><span class="corner corner_1" '+a+'>◆</span><span class="corner corner_2" '+o+">◆</span></div>";return e("#floatCorner_"+t).size()||e("body").append(e(r)),this.corner=e("#floatCorner_"+t),this},targetHold:function(){if(this.s.hoverHold){var e=parseInt(this.s.hideDelay,10)||200;this.target&&this.target.hover(function(){t.flagDisplay=!0},function(){t.timerHold&&clearTimeout(t.timerHold),t.flagDisplay=!1,t.targetHold()}),t.timerHold=setTimeout(function(){t.displayDetect.call(t)},e)}else this.displayDetect();return this},loading:function(){return this.target=e('<div class="float_loading"></div>'),this.targetShow(),this.target.removeData("width").removeData("height"),this},displayDetect:function(){return!this.flagDisplay&&this.display&&(this.targetHide(),this.timerHold=null),this},targetShow:function(){return t.cornerClear(),this.display=!0,this.container().setWidth().position(),this.target.show(),e.isFunction(this.s.showCall)&&this.s.showCall.call(this.trigger,this.target),this},targetHide:function(){return this.display=!1,this.targetClear(),this.cornerClear(),e.isFunction(this.s.hideCall)&&this.s.hideCall.call(this.trigger),this.target=null,this.trigger=null,this.s={},this.targetProtect=!1,this},targetClear:function(){this.target&&(this.target.data("width")&&this.target.removeData("width").removeData("height"),this.targetProtect&&this.target.children().hide().appendTo(e("body")),this.target.unbind().hide())},cornerClear:function(){this.corner&&this.corner.remove()},target:null,trigger:null,s:{},cacheData:{},targetProtect:!1};e.powerFloat={},e.powerFloat.hide=function(){t.targetHide()};var i={width:"auto",offsets:{x:0,y:0},zIndex:999,eventType:"hover",showDelay:0,hideDelay:0,hoverHold:!0,hoverFollow:!1,targetMode:"common",target:null,targetAttr:"rel",container:null,reverseSharp:!1,position:"4-1",edgeAdjust:!0,showCall:e.noop,hideCall:e.noop}}(jQuery),function(e,t){"use strict";var i="function"==typeof moment,n=!!e.addEventListener,a=e.document,o=e.setTimeout,s=function(e,t,i,a){n?e.addEventListener(t,i,!!a):e.attachEvent("on"+t,i)},r=function(e,t,i,a){n?e.removeEventListener(t,i,!!a):e.detachEvent("on"+t,i)},l=function(e,t,i){var n;a.createEvent?((n=a.createEvent("HTMLEvents")).initEvent(t,!0,!1),n=N(n,i),e.dispatchEvent(n)):a.createEventObject&&(n=a.createEventObject(),n=N(n,i),e.fireEvent("on"+t,n))},d=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},c=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},h=function(e,t){c(e,t)||(e.className=""===e.className?t:e.className+" "+t)},u=function(e,t){e.className=d((" "+e.className+" ").replace(" "+t+" "," "))},p=function(e){return/Array/.test(Object.prototype.toString.call(e))},f=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},g=function(e){return new Date(Date.parse(e.replace(/\.|\-/g,"/")))},v=function(e){return e%4==0&&e%100!=0||e%400==0},m=function(e,t){return[31,v(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},b=function(e){f(e)&&e.setHours(0,0,0,0)},y=function(e,t){return e.getTime()===t.getTime()},N=function(e,t,i){var n,a;for(n in t)(a=void 0!==e[n])&&"object"==typeof t[n]&&void 0===t[n].nodeName?f(t[n])?i&&(e[n]=new Date(t[n].getTime())):p(t[n])?i&&(e[n]=t[n].slice(0)):e[n]=N({},t[n],i):!i&&a||(e[n]=t[n]);return e},C={field:null,bound:void 0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,minYear:1990,maxYear:2099,minMonth:void 0,maxMonth:void 0,isRTL:!1,yearSuffix:"年",showMonthAfterYear:!0,numberOfMonths:1,i18n:{months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["星期天","星期一","星期二","星期三","星期四","星期五","星期六"],weekdaysShort:["日","一","二","三","四","五","六"]},onSelect:null,onOpen:null,onClose:null,onDraw:null},k=function(e,t,i){for(t+=e.firstDay;t>=7;)t-=7;return i?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},w=function(e,t,i,n,a){if(a)return'<td class="is-empty"></td>';var o=[];return n&&o.push("is-disabled"),i&&o.push("is-today"),t&&o.push("is-selected"),'<td data-day="'+e+'" class="'+o.join(" ")+'"><a class="pika-button" href="javascript:void(0);">'+e+"</a></td>"},T=function(e,t){return"<tr>"+(t?e.reverse():e).join("")+"</tr>"},x=function(e){return"<tbody>"+e.join("")+"</tbody>"},D=function(e){var t,i=[];for(t=0;t<7;t++)i.push('<th scope="col"><abbr title="'+k(e,t)+'">'+k(e,t,!0)+"</abbr></th>");return"<thead>"+(e.isRTL?i.reverse():i).join("")+"</thead>"},_=function(e){var t,i,n,a,o,s=e._o,r=e._m,l=e._y,d=l===s.minYear,c=l===s.maxYear,h='<div class="pika-title">',u=!0,f=!0;for(h+='<a class="pika-prev'+(u?"":" is-disabled")+'" href="javascript:void(0);">&lt;</a>',n=[],t=0;t<12;t++)n.push('<option value="'+t+'"'+(t===r?" selected":"")+(d&&t<s.minMonth||c&&t>s.maxMonth?"disabled":"")+">"+s.i18n.months[t]+"</option>");for(a='<div class="pika-label pika-label-month">'+s.i18n.months[r]+'<select class="pika-select pika-select-month">'+n.join("")+"</select></div>",p(s.yearRange)?(t=s.yearRange[0],i=s.yearRange[1]+1):(t=l-s.yearRange,i=1+l+s.yearRange),n=[];t<i&&t<=s.maxYear;t++)t>=s.minYear&&n.push('<option value="'+t+'"'+(t===l?" selected":"")+">"+t+"</option>");return o='<div class="pika-label pika-label-year">'+l+s.yearSuffix+'<select class="pika-select pika-select-year">'+n.join("")+"</select></div>",s.showMonthAfterYear?h+=o+a:h+=a+o,d&&(0===r||s.minMonth>=r)&&(u=!1),c&&(11===r||s.maxMonth<=r)&&(f=!1),h+='<a class="pika-next'+(f?"":" is-disabled")+'" href="javascript:void(0);">&gt;</a>',h+="</div>"},E=function(e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+D(e)+x(t)+"</table>"},I=function(t){var r=this,l=r.config(t);r._onMouseDown=function(t){if(r._v){var i=(t=t||e.event).target||t.srcElement;if(i){if(!c(i,"is-disabled")){if(c(i,"pika-button")&&!c(i,"is-empty"))return r.setDate(new Date(r._y,r._m,parseInt(i.innerHTML,10))),void(l.bound&&o(function(){r.hide()},100));c(i,"pika-prev")?r.prevMonth():c(i,"pika-next")&&r.nextMonth()}if(r._c=!0,!c(i,"pika-select")){if(!t.preventDefault)return t.returnValue=!1,t.cancelBubble=!0,!1;t.preventDefault(),t.stopPropagation()}}}},r._onChange=function(t){var i=(t=t||e.event).target||t.srcElement;i&&(c(i,"pika-select-month")?r.gotoMonth(i.value):c(i,"pika-select-year")&&r.gotoYear(i.value))},r._onInputChange=function(e){var t;e.firedBy!==r&&(t=i?(t=moment(l.field.value,l.format))&&t.isValid()?t.toDate():null:g(l.field.value),r.setDate(f(t)?t:null),r._v||r.show())},r._onInputFocus=function(){r.show()},r._onInputClick=function(){r.show()},r._onInputBlur=function(){r._c||(r._b=o(function(){r.hide()},50)),r._c=!1},r._onClick=function(t){var i=(t=t||e.event).target||t.srcElement,a=i;if(i){!n&&c(i,"pika-select")&&(i.onchange||(i.setAttribute("onchange","return;"),s(i,"change",r._onChange)));do{if(c(a,"pika-single"))return}while(a=a.parentNode);r._v&&i!==l.trigger&&r.hide()}},r.el=a.createElement("div"),r.el.className="pika-single"+(l.isRTL?" is-rtl":""),s(r.el,"mousedown",r._onMouseDown,!0),s(r.el,"change",r._onChange),l.field&&(l.bound?a.body.appendChild(r.el):l.field.parentNode.insertBefore(r.el,l.field.nextSibling),s(l.field,"change",r._onInputChange),l.defaultDate||(i&&l.field.value?l.defaultDate=moment(l.field.value,l.format).toDate():l.defaultDate=g(l.field.value),l.setDefaultDate=!0));var d=l.defaultDate;f(d)?l.setDefaultDate?r.setDate(d,!0):r.gotoDate(d):r.gotoDate(new Date),l.bound?(this.hide(),r.el.className+=" is-bound",s(l.trigger,"click",r._onInputClick),s(l.trigger,"focus",r._onInputFocus),s(l.trigger,"blur",r._onInputBlur)):this.show()};I.prototype={config:function(e){this._o||(this._o=N({},C,!0));var t=N(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field;var i=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=i>4?4:i,f(t.minDate)||(t.minDate=!1),f(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&(b(t.minDate),t.minYear=t.minDate.getFullYear(),t.minMonth=t.minDate.getMonth()),t.maxDate&&(b(t.maxDate),t.maxYear=t.maxDate.getFullYear(),t.maxMonth=t.maxDate.getMonth()),p(t.yearRange)){var n=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||n,t.yearRange[1]=parseInt(t.yearRange[1],10)||n}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||C.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(e){if(!f(this._d))return"";var t=this._d.getFullYear(),n=this._d.getMonth()+1,a=this._d.getDate();return n=n<10?"0"+n:n,a=a<10?"0"+a:a,f(this._d)?i?moment(this._d).format(e||this._o.format):t+"-"+n+"-"+a:""},getMoment:function(){return i?moment(this._d):null},setMoment:function(e){i&&moment.isMoment(e)&&this.setDate(e.toDate())},getDate:function(){return f(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this.draw();if("string"==typeof e&&(e=g(e)),f(e)){var i=this._o.minDate,n=this._o.maxDate;f(i)&&e<i?e=i:f(n)&&e>n&&(e=n),this._d=new Date(e.getTime()),b(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),l(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){f(e)&&(this._y=e.getFullYear(),this._m=e.getMonth(),this.draw())},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e=parseInt(e,10))||(this._m=e<0?0:e>11?11:e,this.draw())},nextMonth:function(){++this._m>11&&(this._m=0,this._y++),this.draw()},prevMonth:function(){--this._m<0&&(this._m=11,this._y--),this.draw()},gotoYear:function(e){isNaN(e)||(this._y=parseInt(e,10),this.draw())},setMinDate:function(e){this._o.minDate=e},setMaxDate:function(e){this._o.maxDate=e},draw:function(e){if(this._v||e){var t=this._o,i=t.minYear,n=t.maxYear,a=t.minMonth,s=t.maxMonth;if(this._y<=i&&(this._y=i,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=n&&(this._y=n,!isNaN(s)&&this._m>s&&(this._m=s)),this.el.innerHTML=_(this)+this.render(this._y,this._m),t.bound&&(this.adjustPosition(),"hidden"!==t.field.type&&o(function(){t.trigger.focus()},1)),"function"==typeof this._o.onDraw){var r=this;o(function(){r._o.onDraw.call(r)},0)}}},adjustPosition:function(){var t,i,n,o=this._o.trigger,s=o,r=this.el.offsetWidth,l=this.el.offsetHeight,d=e.innerWidth||a.documentElement.clientWidth,c=e.innerHeight||a.documentElement.clientHeight,p=e.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop;if(h(this.el,"is-hidden"),"function"==typeof o.getBoundingClientRect)t=(n=o.getBoundingClientRect()).left+e.pageXOffset,i=n.bottom+e.pageYOffset;else for(t=s.offsetLeft,i=s.offsetTop+s.offsetHeight;s=s.offsetParent;)t+=s.offsetLeft,i+=s.offsetTop;u(this.el,"is-hidden"),t+r>d&&(t=t-r+o.offsetWidth),i+l>c+p&&(i=i-l-o.offsetHeight),this.el.style.cssText="position:absolute;left:"+t+"px;top:"+i+"px;"},render:function(e,t){var i=this._o,n=new Date,a=m(e,t),o=new Date(e,t,1).getDay(),s=[],r=[];b(n),i.firstDay>0&&(o-=i.firstDay)<0&&(o+=7);for(var l=a+o,d=l;d>7;)d-=7;l+=7-d;for(var c=0,h=0;c<l;c++){var u=new Date(e,t,c-o+1),p=i.minDate&&u<i.minDate||i.maxDate&&u>i.maxDate,g=!!f(this._d)&&y(u,this._d),v=y(u,n),N=c<o||c>=a+o;r.push(w(c-o+1,g,v,p,N)),7==++h&&(s.push(T(r,i.isRTL)),r=[],h=0)}return E(i,s)},isVisible:function(){return this._v},show:function(){this._v||(this._o.bound&&s(a,"click",this._onClick),u(this.el,"is-hidden"),this._v=!0,this.draw(),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&r(a,"click",this._onClick),this.el.style.cssText="",h(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),r(this.el,"mousedown",this._onMouseDown,!0),r(this.el,"change",this._onChange),this._o.field&&(r(this._o.field,"change",this._onInputChange),this._o.bound&&(r(this._o.trigger,"click",this._onInputClick),r(this._o.trigger,"focus",this._onInputFocus),r(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},e.Pikaday=I}(window),function(e,t){e.define&&"function"==typeof define?define(function(i){t(i("jquery"),e.Pikaday)}):t(e.jQuery,e.Pikaday)}(this,function(e,t){e&&(e.fn.datepicker=e.fn.pikaday=function(){var i=arguments;return i&&i.length||(i=[{}]),this.each(function(){var n=e(this),a=n.data("pikaday");if(a instanceof t)"string"==typeof i[0]&&"function"==typeof a[i[0]]&&a[i[0]].apply(a,Array.prototype.slice.call(i,1));else if("object"==typeof i[0]){var o=e.extend({},i[0]);o.field=n[0],n.data("pikaday",new t(o))}})})}),$.fn.printArea=function(e){e=$.extend({preview:!1,table:!1,usePageStyle:!0},e);for(var t,i=document.getElementsByTagName("link"),n='<!doctype html><html><head><meta charset="utf-8"><title></title>',a=0,o=i.length;a<o;a++)"stylesheet"===i[a].rel&&(e.usePageStyle||-1!==i[a].href.indexOf("print.css"))&&(n+=i[a].outerHTML);n+="</head><body>"+(e.table?"":this[0].outerHTML)+"</body></html>";var s,r=this,l=$(n);(t=document.createElement("iframe")).id="printProxyIframe",t.frameBorder=0,t.setAttribute("style","position:absolute;z-index:100;left:0;top:0;width:100%;height:100%;background:#fff;"+(e.preview?"":"visibility:hidden;")),t.onload=function(){(s=t.contentWindow).canAccess=!0},t.src="javascript:void((function(){document.open();document.domain='"+document.domain+"';document.close()})())",document.body.appendChild(t);var d=setInterval(function(){if(t.contentWindow.canAccess){if(clearInterval(d),s.onafterprint=function(){s.onafterprint=null,t.parentNode.removeChild(t)},e.table){var i=r.find("table.ui-jqgrid-htable").eq(0).clone().removeAttr("style").attr("class","ui-table-print"),n=r.find("table.ui-jqgrid-btable").eq(0).find("tbody").clone(),a=r.find("div.grid-title"),o=r.find("div.grid-subtitle"),c=r.find("table.ui-jqgrid-ftable").find("tbody").clone();a.length&&$("<caption/>").prependTo(i).append(a.clone()).append(o.clone()),i.find("th").css("width","auto"),c.find("td").css("width","auto"),n.children().eq(0).remove(),i.append(n).append(c),$(s.document.body).append(l).append(i)}d&&clearTimeout(d),d=setTimeout(function(){s.focus(),s.print()},100),e.preview||setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},1e3)}},100);return this},$.fn.printTable=function(e){return e=e||{},e.table=!0,e.usePageStyle=!1,this.printArea(e)},function($){var settings={},roots={},caches={},_consts={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(e){var t=data.getRoot(e);t||(t={},data.setRoot(e,t)),t[e.data.key.children]=[],t.expandTriggerFlag=!1,t.curSelectedList=[],t.noSelection=!0,t.createdNodes=[],t.zId=0,t._ver=(new Date).getTime()},_initCache=function(e){var t=data.getCache(e);t||(t={},data.setCache(e,t)),t.nodes=[],t.doms=[]},_bindEvent=function(e){var t=e.treeObj,i=consts.event;t.bind(i.NODECREATED,function(t,i,n){tools.apply(e.callback.onNodeCreated,[t,i,n])}),t.bind(i.CLICK,function(t,i,n,a,o){tools.apply(e.callback.onClick,[i,n,a,o])}),t.bind(i.EXPAND,function(t,i,n){tools.apply(e.callback.onExpand,[t,i,n])}),t.bind(i.COLLAPSE,function(t,i,n){tools.apply(e.callback.onCollapse,[t,i,n])}),t.bind(i.ASYNC_SUCCESS,function(t,i,n,a){tools.apply(e.callback.onAsyncSuccess,[t,i,n,a])}),t.bind(i.ASYNC_ERROR,function(t,i,n,a,o,s){tools.apply(e.callback.onAsyncError,[t,i,n,a,o,s])}),t.bind(i.REMOVE,function(t,i,n){tools.apply(e.callback.onRemove,[t,i,n])})},_unbindEvent=function(e){var t=e.treeObj,i=consts.event;t.unbind(i.NODECREATED).unbind(i.CLICK).unbind(i.EXPAND).unbind(i.COLLAPSE).unbind(i.ASYNC_SUCCESS).unbind(i.ASYNC_ERROR).unbind(i.REMOVE)},_eventProxy=function(e){var t=e.target,i=data.getSetting(e.data.treeId),n="",a=null,o="",s="",r=null,l=null,d=null;if(tools.eqs(e.type,"mousedown")?s="mousedown":tools.eqs(e.type,"mouseup")?s="mouseup":tools.eqs(e.type,"contextmenu")?s="contextmenu":tools.eqs(e.type,"click")?tools.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+consts.id.SWITCH)?(n=tools.getNodeMainDom(t).id,o="switchNode"):(d=tools.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(n=tools.getNodeMainDom(d).id,o="clickNode"):tools.eqs(e.type,"dblclick")&&(s="dblclick",(d=tools.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(n=tools.getNodeMainDom(d).id,o="switchNode")),s.length>0&&0==n.length&&(d=tools.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(n=tools.getNodeMainDom(d).id),n.length>0)switch(a=data.getNodeCache(i,n),o){case"switchNode":a.isParent&&(tools.eqs(e.type,"click")||tools.eqs(e.type,"dblclick")&&tools.apply(i.view.dblClickExpand,[i.treeId,a],i.view.dblClickExpand))?r=handler.onSwitchNode:o="";break;case"clickNode":r=handler.onClickNode}switch(s){case"mousedown":l=handler.onZTreeMousedown;break;case"mouseup":l=handler.onZTreeMouseup;break;case"dblclick":l=handler.onZTreeDblclick;break;case"contextmenu":l=handler.onZTreeContextmenu}return{stop:!1,node:a,nodeEventType:o,nodeEventCallback:r,treeEventType:s,treeEventCallback:l}},_initNode=function(e,t,i,n,a,o,s){if(i){var r=data.getRoot(e),l=e.data.key.children;i.level=t,i.tId=e.treeId+"_"+ ++r.zId,i.parentTId=n?n.tId:null,i.open="string"==typeof i.open?tools.eqs(i.open,"true"):!!i.open,i[l]&&i[l].length>0?(i.isParent=!0,i.zAsync=!0):(i.isParent="string"==typeof i.isParent?tools.eqs(i.isParent,"true"):!!i.isParent,i.open=!(!i.isParent||e.async.enable)&&i.open,i.zAsync=!i.isParent),i.isFirstNode=a,i.isLastNode=o,i.getParentNode=function(){return data.getNodeCache(e,i.parentTId)},i.getPreNode=function(){return data.getPreNode(e,i)},i.getNextNode=function(){return data.getNextNode(e,i)},i.isAjaxing=!1,data.fixPIdKeyValue(e,i)}},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(e,t){data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){_init.afterA.push(e)},addBeforeA:function(e){_init.beforeA.push(e)},addInnerAfterA:function(e){_init.innerAfterA.push(e)},addInnerBeforeA:function(e){_init.innerBeforeA.push(e)},addInitBind:function(e){_init.bind.push(e)},addInitUnBind:function(e){_init.unbind.push(e)},addInitCache:function(e){_init.caches.push(e)},addInitNode:function(e){_init.nodes.push(e)},addInitProxy:function(e,t){t?_init.proxys.splice(0,0,e):_init.proxys.push(e)},addInitRoot:function(e){_init.roots.push(e)},addNodesData:function(e,t,i){var n=e.data.key.children;t[n]||(t[n]=[]),t[n].length>0&&(t[n][t[n].length-1].isLastNode=!1,view.setNodeLineIcos(e,t[n][t[n].length-1])),t.isParent=!0,t[n]=t[n].concat(i)},addSelectedNode:function(e,t){var i=data.getRoot(e);data.isSelectedNode(e,t)||i.curSelectedList.push(t)},addCreatedNode:function(e,t){(e.callback.onNodeCreated||e.view.addDiyDom)&&data.getRoot(e).createdNodes.push(t)},addZTreeTools:function(e){_init.zTreeTools.push(e)},exSetting:function(e){$.extend(!0,_setting,e)},fixPIdKeyValue:function(e,t){e.data.simpleData.enable&&(t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(e,t,i){for(var n=0,a=_init.afterA.length;n<a;n++)_init.afterA[n].apply(this,arguments)},getBeforeA:function(e,t,i){for(var n=0,a=_init.beforeA.length;n<a;n++)_init.beforeA[n].apply(this,arguments)},getInnerAfterA:function(e,t,i){for(var n=0,a=_init.innerAfterA.length;n<a;n++)_init.innerAfterA[n].apply(this,arguments)},getInnerBeforeA:function(e,t,i){for(var n=0,a=_init.innerBeforeA.length;n<a;n++)_init.innerBeforeA[n].apply(this,arguments)},getCache:function(e){return caches[e.treeId]},getNextNode:function(e,t){if(!t)return null;for(var i=e.data.key.children,n=t.parentTId?t.getParentNode():data.getRoot(e),a=0,o=n[i].length-1;a<=o;a++)if(n[i][a]===t)return a==o?null:n[i][a+1];return null},getNodeByParam:function(e,t,i,n){if(!t||!i)return null;for(var a=e.data.key.children,o=0,s=t.length;o<s;o++){if(t[o][i]==n)return t[o];var r=data.getNodeByParam(e,t[o][a],i,n);if(r)return r}return null},getNodeCache:function(e,t){if(!t)return null;var i=caches[e.treeId].nodes[data.getNodeCacheId(t)];return i||null},getNodeName:function(e,t){return""+t[e.data.key.name]},getNodeTitle:function(e,t){return""+t[""===e.data.key.title?e.data.key.name:e.data.key.title]},getNodes:function(e){return data.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,t,i,n){if(!t||!i)return[];for(var a=e.data.key.children,o=[],s=0,r=t.length;s<r;s++)t[s][i]==n&&o.push(t[s]),o=o.concat(data.getNodesByParam(e,t[s][a],i,n));return o},getNodesByParamFuzzy:function(e,t,i,n){if(!t||!i)return[];var a=e.data.key.children,o=[];n=n.toLowerCase();for(var s=0,r=t.length;s<r;s++)"string"==typeof t[s][i]&&t[s][i].toLowerCase().indexOf(n)>-1&&o.push(t[s]),o=o.concat(data.getNodesByParamFuzzy(e,t[s][a],i,n));return o},getNodesByFilter:function(e,t,i,n,a){if(!t)return n?null:[];for(var o=e.data.key.children,s=n?null:[],r=0,l=t.length;r<l;r++){if(tools.apply(i,[t[r],a],!1)){if(n)return t[r];s.push(t[r])}var d=data.getNodesByFilter(e,t[r][o],i,n,a);if(n&&d)return d;s=n?d:s.concat(d)}return s},getPreNode:function(e,t){if(!t)return null;for(var i=e.data.key.children,n=t.parentTId?t.getParentNode():data.getRoot(e),a=0,o=n[i].length;a<o;a++)if(n[i][a]===t)return 0==a?null:n[i][a-1];return null},getRoot:function(e){return e?roots[e.treeId]:null},getRoots:function(){return roots},getSetting:function(e){return settings[e]},getSettings:function(){return settings},getZTreeTools:function(e){var t=this.getRoot(this.getSetting(e));return t?t.treeTools:null},initCache:function(e){for(var t=0,i=_init.caches.length;t<i;t++)_init.caches[t].apply(this,arguments)},initNode:function(e,t,i,n,a,o){for(var s=0,r=_init.nodes.length;s<r;s++)_init.nodes[s].apply(this,arguments)},initRoot:function(e){for(var t=0,i=_init.roots.length;t<i;t++)_init.roots[t].apply(this,arguments)},isSelectedNode:function(e,t){for(var i=data.getRoot(e),n=0,a=i.curSelectedList.length;n<a;n++)if(t===i.curSelectedList[n])return!0;return!1},removeNodeCache:function(e,t){var i=e.data.key.children;if(t[i])for(var n=0,a=t[i].length;n<a;n++)arguments.callee(e,t[i][n]);data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){for(var i=data.getRoot(e),n=0,a=i.curSelectedList.length;n<a;n++)t!==i.curSelectedList[n]&&data.getNodeCache(e,i.curSelectedList[n].tId)||(i.curSelectedList.splice(n,1),n--,a--)},setCache:function(e,t){caches[e.treeId]=t},setRoot:function(e,t){roots[e.treeId]=t},setZTreeTools:function(e,t){for(var i=0,n=_init.zTreeTools.length;i<n;i++)_init.zTreeTools[i].apply(this,arguments)},transformToArrayFormat:function(e,t){if(!t)return[];var i=e.data.key.children,n=[];if(tools.isArray(t))for(var a=0,o=t.length;a<o;a++)n.push(t[a]),t[a][i]&&(n=n.concat(data.transformToArrayFormat(e,t[a][i])));else n.push(t),t[i]&&(n=n.concat(data.transformToArrayFormat(e,t[i])));return n},transformTozTreeFormat:function(e,t){var i,n,a=e.data.simpleData.idKey,o=e.data.simpleData.pIdKey,s=e.data.key.children;if(!a||""==a||!t)return[];if(tools.isArray(t)){var r=[],l=[];for(i=0,n=t.length;i<n;i++)l[t[i][a]]=t[i];for(i=0,n=t.length;i<n;i++)l[t[i][o]]&&t[i][a]!=t[i][o]?(l[t[i][o]][s]||(l[t[i][o]][s]=[]),l[t[i][o]][s].push(t[i])):r.push(t[i]);return r}return[t]}},event={bindEvent:function(e){for(var t=0,i=_init.bind.length;t<i;t++)_init.bind[t].apply(this,arguments)},unbindEvent:function(e){for(var t=0,i=_init.unbind.length;t<i;t++)_init.unbind[t].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},i=e.treeObj;e.view.txtSelectedEnable||i.bind("selectstart",function(e){var t=e.originalEvent.srcElement.nodeName.toLowerCase();return"input"===t||"textarea"===t}).css({"-moz-user-select":"-moz-none"}),i.bind("click",t,event.proxy),i.bind("dblclick",t,event.proxy),i.bind("mouseover",t,event.proxy),i.bind("mouseout",t,event.proxy),i.bind("mousedown",t,event.proxy),i.bind("mouseup",t,event.proxy),i.bind("contextmenu",t,event.proxy)},unbindTree:function(e){e.treeObj.unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(e){for(var t=[],i=0,n=_init.proxys.length;i<n;i++){var a=_init.proxys[i].apply(this,arguments);if(t.push(a),a.stop)break}return t},proxy:function(e){var t=data.getSetting(e.data.treeId);if(!tools.uCanDo(t,e))return!0;for(var i=event.doProxy(e),n=!0,a=0,o=i.length;a<o;a++){var s=i[a];s.nodeEventCallback&&(!0,n=s.nodeEventCallback.apply(s,[e,s.node])&&n),s.treeEventCallback&&(!0,n=s.treeEventCallback.apply(s,[e,s.node])&&n)}return n}},handler={onSwitchNode:function(e,t){var i=data.getSetting(e.data.treeId);if(t.open){if(0==tools.apply(i.callback.beforeCollapse,[i.treeId,t],!0))return!0;data.getRoot(i).expandTriggerFlag=!0,view.switchNode(i,t)}else{if(0==tools.apply(i.callback.beforeExpand,[i.treeId,t],!0))return!0;data.getRoot(i).expandTriggerFlag=!0,view.switchNode(i,t)}return!0},onClickNode:function(e,t){var i=data.getSetting(e.data.treeId),n=i.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&data.isSelectedNode(i,t)?0:i.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&i.view.selectedMulti?2:1;return 0==tools.apply(i.callback.beforeClick,[i.treeId,t,n],!0)||(0===n?view.cancelPreSelectedNode(i,t):view.selectNode(i,t,2===n),i.treeObj.trigger(consts.event.CLICK,[e,i.treeId,t,n]),!0)},onZTreeMousedown:function(e,t){var i=data.getSetting(e.data.treeId);return tools.apply(i.callback.beforeMouseDown,[i.treeId,t],!0)&&tools.apply(i.callback.onMouseDown,[e,i.treeId,t]),!0},onZTreeMouseup:function(e,t){var i=data.getSetting(e.data.treeId);return tools.apply(i.callback.beforeMouseUp,[i.treeId,t],!0)&&tools.apply(i.callback.onMouseUp,[e,i.treeId,t]),!0},onZTreeDblclick:function(e,t){var i=data.getSetting(e.data.treeId);return tools.apply(i.callback.beforeDblClick,[i.treeId,t],!0)&&tools.apply(i.callback.onDblClick,[e,i.treeId,t]),!0},onZTreeContextmenu:function(e,t){var i=data.getSetting(e.data.treeId);return tools.apply(i.callback.beforeRightClick,[i.treeId,t],!0)&&tools.apply(i.callback.onRightClick,[e,i.treeId,t]),"function"!=typeof i.callback.onRightClick}},tools={apply:function(e,t,i){return"function"==typeof e?e.apply(zt,t||[]):i},canAsync:function(e,t){var i=e.data.key.children;return e.async.enable&&t&&t.isParent&&!(t.zAsync||t[i]&&t[i].length>0)},clone:function(e){if(null===e)return null;var t=tools.isArray(e)?[]:{};for(var i in e)t[i]=e[i]instanceof Date?new Date(e[i].getTime()):"object"==typeof e[i]?arguments.callee(e[i]):e[i];return t},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},$:function(e,t,i){return t&&"string"!=typeof t&&(i=t,t=""),"string"==typeof e?$(e,i?i.treeObj.get(0).ownerDocument:null):$("#"+e.tId+t,i?i.treeObj:null)},getMDom:function(e,t,i){if(!t)return null;for(;t&&t.id!==e.treeId;){for(var n=0,a=i.length;t.tagName&&n<a;n++)if(tools.eqs(t.tagName,i[n].tagName)&&null!==t.getAttribute(i[n].attrName))return t;t=t.parentNode}return null},getNodeMainDom:function(e){return $(e).parent("li").get(0)||$(e).parentsUntil("li").parent().get(0)},isChildOrSelf:function(e,t){return $(e).closest("#"+t).length>0},uCanDo:function(e,t){return!0}},view={addNodes:function(e,t,i,n){if(!e.data.keep.leaf||!t||t.isParent)if(tools.isArray(i)||(i=[i]),e.data.simpleData.enable&&(i=data.transformTozTreeFormat(e,i)),t){var a=$$(t,consts.id.SWITCH,e),o=$$(t,consts.id.ICON,e),s=$$(t,consts.id.UL,e);t.open||(view.replaceSwitchClass(t,a,consts.folder.CLOSE),view.replaceIcoClass(t,o,consts.folder.CLOSE),t.open=!1,s.css({display:"none"})),data.addNodesData(e,t,i),view.createNodes(e,t.level+1,i,t),n||view.expandCollapseParentNode(e,t,!0)}else data.addNodesData(e,data.getRoot(e),i),view.createNodes(e,0,i,null)},appendNodes:function(e,t,i,n,a,o){if(!i)return[];for(var s=[],r=e.data.key.children,l=0,d=i.length;l<d;l++){var c=i[l];if(a){var h=(n||data.getRoot(e))[r].length==i.length&&0==l,u=l==i.length-1;data.initNode(e,t,c,n,h,u,o),data.addNodeCache(e,c)}var p=[];c[r]&&c[r].length>0&&(p=view.appendNodes(e,t+1,c[r],c,a,o&&c.open)),o&&(view.makeDOMNodeMainBefore(s,e,c),view.makeDOMNodeLine(s,e,c),data.getBeforeA(e,c,s),view.makeDOMNodeNameBefore(s,e,c),data.getInnerBeforeA(e,c,s),view.makeDOMNodeIcon(s,e,c),data.getInnerAfterA(e,c,s),view.makeDOMNodeNameAfter(s,e,c),data.getAfterA(e,c,s),c.isParent&&c.open&&view.makeUlHtml(e,c,s,p.join("")),view.makeDOMNodeMainAfter(s,e,c),data.addCreatedNode(e,c))}return s},appendParentULDom:function(e,t){var i=[],n=$$(t,e);!n.get(0)&&t.parentTId&&(view.appendParentULDom(e,t.getParentNode()),n=$$(t,e));var a=$$(t,consts.id.UL,e);a.get(0)&&a.remove();var o=e.data.key.children,s=view.appendNodes(e,t.level+1,t[o],t,!1,!0);view.makeUlHtml(e,t,i,s.join("")),n.append(i.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,l;if(node&&!node.isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(0==tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0))return tools.apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=$$(node,consts.id.ICON,setting);icoObj.attr({style:"",class:consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={};for(i=0,l=setting.async.autoParam.length;node&&i<l;i++){var pKey=setting.async.autoParam[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}if(tools.isArray(setting.async.otherParam))for(i=0,l=setting.async.otherParam.length;i<l;i+=2)tmpParam[setting.async.otherParam[i]]=setting.async.otherParam[i+1];else for(var p in setting.async.otherParam)tmpParam[p]=setting.async.otherParam[p];var _tmpV=data.getRoot(setting)._ver;return $.ajax({contentType:setting.async.contentType,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:tmpParam,dataType:setting.async.dataType,success:function(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&0!=msg.length?"string"==typeof msg?eval("("+msg+")"):msg:[]}catch(e){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),view.setNodeLineIcos(setting,node),newNodes&&""!==newNodes?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,newNodes?tools.clone(newNodes):[],!!isSilent)):view.addNodes(setting,node,[],!!isSilent),setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),tools.apply(callback)}},error:function(e,t,i){_tmpV==data.getRoot(setting)._ver&&(node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,e,t,i]))}}),!0},cancelPreSelectedNode:function(e,t){for(var i=data.getRoot(e).curSelectedList,n=i.length-1;n>=0;n--)if((!t||t===i[n])&&($$(i[n],consts.id.A,e).removeClass(consts.node.CURSELECTED),t)){data.removeSelectedNode(e,t);break}t||(data.getRoot(e).curSelectedList=[])},createNodeCallback:function(e){if(e.callback.onNodeCreated||e.view.addDiyDom)for(var t=data.getRoot(e);t.createdNodes.length>0;){var i=t.createdNodes.shift();tools.apply(e.view.addDiyDom,[e.treeId,i]),e.callback.onNodeCreated&&e.treeObj.trigger(consts.event.NODECREATED,[e.treeId,i])}},createNodes:function(e,t,i,n){if(i&&0!=i.length){var a=data.getRoot(e),o=e.data.key.children,s=!n||n.open||!!$$(n[o][0],e).get(0);a.createdNodes=[];var r=view.appendNodes(e,t,i,n,!0,s);if(n){var l=$$(n,consts.id.UL,e);l.get(0)&&l.append(r.join(""))}else e.treeObj.append(r.join(""));view.createNodeCallback(e)}},destroy:function(e){e&&(data.initCache(e),data.initRoot(e),event.unbindTree(e),event.unbindEvent(e),e.treeObj.empty(),delete settings[e.treeId])},expandCollapseNode:function(e,t,i,n,a){var o=data.getRoot(e),s=e.data.key.children;if(t){if(o.expandTriggerFlag){var r=a;a=function(){r&&r(),t.open?e.treeObj.trigger(consts.event.EXPAND,[e.treeId,t]):e.treeObj.trigger(consts.event.COLLAPSE,[e.treeId,t])},o.expandTriggerFlag=!1}if(!t.open&&t.isParent&&(!$$(t,consts.id.UL,e).get(0)||t[s]&&t[s].length>0&&!$$(t[s][0],e).get(0))&&(view.appendParentULDom(e,t),view.createNodeCallback(e)),t.open!=i){var l=$$(t,consts.id.UL,e),d=$$(t,consts.id.SWITCH,e),c=$$(t,consts.id.ICON,e);t.isParent?(t.open=!t.open,t.iconOpen&&t.iconClose&&c.attr("style",view.makeNodeIcoStyle(e,t)),t.open?(view.replaceSwitchClass(t,d,consts.folder.OPEN),view.replaceIcoClass(t,c,consts.folder.OPEN),0==n||""==e.view.expandSpeed?(l.show(),tools.apply(a,[])):t[s]&&t[s].length>0?l.slideDown(e.view.expandSpeed,a):(l.show(),tools.apply(a,[]))):(view.replaceSwitchClass(t,d,consts.folder.CLOSE),view.replaceIcoClass(t,c,consts.folder.CLOSE),0!=n&&""!=e.view.expandSpeed&&t[s]&&t[s].length>0?l.slideUp(e.view.expandSpeed,a):(l.hide(),tools.apply(a,[])))):tools.apply(a,[])}else tools.apply(a,[])}else tools.apply(a,[])},expandCollapseParentNode:function(e,t,i,n,a){t&&(t.parentTId?(view.expandCollapseNode(e,t,i,n),t.parentTId&&view.expandCollapseParentNode(e,t.getParentNode(),i,n,a)):view.expandCollapseNode(e,t,i,n,a))},expandCollapseSonNode:function(e,t,i,n,a){var o=data.getRoot(e),s=e.data.key.children,r=t?t[s]:o[s],l=!t&&n,d=data.getRoot(e).expandTriggerFlag;if(data.getRoot(e).expandTriggerFlag=!1,r)for(var c=0,h=r.length;c<h;c++)r[c]&&view.expandCollapseSonNode(e,r[c],i,l);data.getRoot(e).expandTriggerFlag=d,view.expandCollapseNode(e,t,i,n,a)},makeDOMNodeIcon:function(e,t,i){var n=data.getNodeName(t,i),a=t.view.nameIsHTML?n:n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",i.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(t,i),"' style='",view.makeNodeIcoStyle(t,i),"'></span><span id='",i.tId,consts.id.SPAN,"'>",a,"</span>")},makeDOMNodeLine:function(e,t,i){e.push("<span id='",i.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(t,i),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e,t,i){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,i){e.push("<li id='",i.tId,"' class='",consts.className.LEVEL,i.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e,t,i){e.push("</a>")},makeDOMNodeNameBefore:function(e,t,i){var n=data.getNodeTitle(t,i),a=view.makeNodeUrl(t,i),o=view.makeNodeFontCss(t,i),s=[];for(var r in o)s.push(r,":",o[r],";");e.push("<a id='",i.tId,consts.id.A,"' class='",consts.className.LEVEL,i.level,"' treeNode",consts.id.A,' onclick="',i.click||"",'" ',null!=a&&a.length>0?"href='"+a+"'":""," target='",view.makeNodeTarget(i),"' style='",s.join(""),"'"),tools.apply(t.view.showTitle,[t.treeId,i],t.view.showTitle)&&n&&e.push("title='",n.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),e.push(">")},makeNodeFontCss:function(e,t){var i=tools.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return i&&"function"!=typeof i?i:{}},makeNodeIcoClass:function(e,t){var i=["ico"];return t.isAjaxing||(i[0]=(t.iconSkin?t.iconSkin+"_":"")+i[0],t.isParent?i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):i.push(consts.folder.DOCU)),consts.className.BUTTON+" "+i.join("_")},makeNodeIcoStyle:function(e,t){var i=[];if(!t.isAjaxing){var n=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t.icon;n&&i.push("background:url(",n,") 0 0 no-repeat;"),0!=e.view.showIcon&&tools.apply(e.view.showIcon,[e.treeId,t],!0)||i.push("width:0px;height:0px;")}return i.join("")},makeNodeLineClass:function(e,t){var i=[];return e.view.showLine?0==t.level&&t.isFirstNode&&t.isLastNode?i.push(consts.line.ROOT):0==t.level&&t.isFirstNode?i.push(consts.line.ROOTS):t.isLastNode?i.push(consts.line.BOTTOM):i.push(consts.line.CENTER):i.push(consts.line.NOLINE),t.isParent?i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):i.push(consts.folder.DOCU),view.makeNodeLineClassEx(t)+i.join("_")},makeNodeLineClassEx:function(e){return consts.className.BUTTON+" "+consts.className.LEVEL+e.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var i=e.data.key.url;return t[i]?t[i]:null},makeUlHtml:function(e,t,i,n){i.push("<ul id='",t.tId,consts.id.UL,"' class='",consts.className.LEVEL,t.level," ",view.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>"),i.push(n),i.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?consts.line.LINE:""},removeChildNodes:function(e,t){if(t){var i=e.data.key.children,n=t[i];if(n){for(var a=0,o=n.length;a<o;a++)data.removeNodeCache(e,n[a]);if(data.removeSelectedNode(e),delete t[i],e.data.keep.parent)$$(t,consts.id.UL,e).empty();else{t.isParent=!1,t.open=!1;var s=$$(t,consts.id.SWITCH,e),r=$$(t,consts.id.ICON,e);view.replaceSwitchClass(t,s,consts.folder.DOCU),view.replaceIcoClass(t,r,consts.folder.DOCU),$$(t,consts.id.UL,e).remove()}}}},setFirstNode:function(e,t){var i=e.data.key.children;t[i].length>0&&(t[i][0].isFirstNode=!0)},setLastNode:function(e,t){var i=e.data.key.children,n=t[i].length;n>0&&(t[i][n-1].isLastNode=!0)},removeNode:function(e,t){var i=data.getRoot(e),n=e.data.key.children,a=t.parentTId?t.getParentNode():i;if(t.isFirstNode=!1,t.isLastNode=!1,t.getPreNode=function(){return null},t.getNextNode=function(){return null},data.getNodeCache(e,t.tId)){$$(t,e).remove(),data.removeNodeCache(e,t),data.removeSelectedNode(e,t);for(var o=0,s=a[n].length;o<s;o++)if(a[n][o].tId==t.tId){a[n].splice(o,1);break}view.setFirstNode(e,a),view.setLastNode(e,a);var r,l,d,c=a[n].length;if(e.data.keep.parent||0!=c){if(e.view.showLine&&c>0){var h=a[n][c-1];if(r=$$(h,consts.id.UL,e),l=$$(h,consts.id.SWITCH,e),d=$$(h,consts.id.ICON,e),a==i)if(1==a[n].length)view.replaceSwitchClass(h,l,consts.line.ROOT);else{var u=$$(a[n][0],consts.id.SWITCH,e);view.replaceSwitchClass(a[n][0],u,consts.line.ROOTS),view.replaceSwitchClass(h,l,consts.line.BOTTOM)}else view.replaceSwitchClass(h,l,consts.line.BOTTOM);r.removeClass(consts.line.LINE)}}else a.isParent=!1,a.open=!1,r=$$(a,consts.id.UL,e),l=$$(a,consts.id.SWITCH,e),d=$$(a,consts.id.ICON,e),view.replaceSwitchClass(a,l,consts.folder.DOCU),view.replaceIcoClass(a,d,consts.folder.DOCU),r.css("display","none")}},replaceIcoClass:function(e,t,i){if(t&&!e.isAjaxing){var n=t.attr("class");if(void 0!=n){var a=n.split("_");switch(i){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:a[a.length-1]=i}t.attr("class",a.join("_"))}}},replaceSwitchClass:function(e,t,i){if(t){var n=t.attr("class");if(void 0!=n){var a=n.split("_");switch(i){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:a[0]=view.makeNodeLineClassEx(e)+i;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:a[1]=i}t.attr("class",a.join("_")),i!==consts.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}}},selectNode:function(e,t,i){i||view.cancelPreSelectedNode(e),$$(t,consts.id.A,e).addClass(consts.node.CURSELECTED),data.addSelectedNode(e,t)},setNodeFontCss:function(e,t){var i=$$(t,consts.id.A,e),n=view.makeNodeFontCss(e,t);n&&i.css(n)},setNodeLineIcos:function(e,t){if(t){var i=$$(t,consts.id.SWITCH,e),n=$$(t,consts.id.UL,e),a=$$(t,consts.id.ICON,e),o=view.makeUlLineClass(e,t);0==o.length?n.removeClass(consts.line.LINE):n.addClass(o),i.attr("class",view.makeNodeLineClass(e,t)),t.isParent?i.removeAttr("disabled"):i.attr("disabled","disabled"),a.removeAttr("style"),a.attr("style",view.makeNodeIcoStyle(e,t)),a.attr("class",view.makeNodeIcoClass(e,t))}},setNodeName:function(e,t){var i=data.getNodeTitle(e,t),n=$$(t,consts.id.SPAN,e);n.empty(),e.view.nameIsHTML?n.html(data.getNodeName(e,t)):n.text(data.getNodeName(e,t)),tools.apply(e.view.showTitle,[e.treeId,t],e.view.showTitle)&&$$(t,consts.id.A,e).attr("title",i||"")},setNodeTarget:function(e,t){$$(t,consts.id.A,e).attr("target",view.makeNodeTarget(t))},setNodeUrl:function(e,t){var i=$$(t,consts.id.A,e),n=view.makeNodeUrl(e,t);null==n||0==n.length?i.removeAttr("href"):i.attr("href",n)},switchNode:function(e,t){if(t.open||!tools.canAsync(e,t))view.expandCollapseNode(e,t,!t.open);else if(e.async.enable){if(!view.asyncNode(e,t))return void view.expandCollapseNode(e,t,!t.open)}else t&&view.expandCollapseNode(e,t,!t.open)}};$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(e){var t=data.getZTreeTools(e);return t||null},destroy:function(e){if(e&&e.length>0)view.destroy(data.getSetting(e));else for(var t in settings)view.destroy(settings[t])},init:function(e,t,i){var n=tools.clone(_setting);$.extend(!0,n,t),n.treeId=e.attr("id"),n.treeObj=e,n.treeObj.empty(),settings[n.treeId]=n,void 0===document.body.style.maxHeight&&(n.view.expandSpeed=""),data.initRoot(n);var a=data.getRoot(n),o=n.data.key.children;i=i?tools.clone(tools.isArray(i)?i:[i]):[],n.data.simpleData.enable?a[o]=data.transformTozTreeFormat(n,i):a[o]=i,data.initCache(n),event.unbindTree(n),event.bindTree(n),event.unbindEvent(n),event.bindEvent(n);var s={setting:n,addNodes:function(e,t,i){function a(){view.addNodes(n,e,o,1==i)}if(!t)return null;if(e||(e=null),e&&!e.isParent&&n.data.keep.leaf)return null;var o=tools.clone(tools.isArray(t)?t:[t]);return tools.canAsync(n,e)?view.asyncNode(n,e,i,a):a(),o},cancelSelectedNode:function(e){view.cancelPreSelectedNode(n,e)},destroy:function(){view.destroy(n)},expandAll:function(e){return e=!!e,view.expandCollapseSonNode(n,null,e,!0),e},expandNode:function(e,t,i,a,o){if(!e||!e.isParent)return null;if(!0!==t&&!1!==t&&(t=!e.open),(o=!!o)&&t&&0==tools.apply(n.callback.beforeExpand,[n.treeId,e],!0))return null;if(o&&!t&&0==tools.apply(n.callback.beforeCollapse,[n.treeId,e],!0))return null;if(t&&e.parentTId&&view.expandCollapseParentNode(n,e.getParentNode(),t,!1),t===e.open&&!i)return null;if(data.getRoot(n).expandTriggerFlag=o,!tools.canAsync(n,e)&&i)view.expandCollapseSonNode(n,e,t,!0,function(){if(!1!==a)try{$$(e,n).focus().blur()}catch(e){}});else if(e.open=!t,view.switchNode(this.setting,e),!1!==a)try{$$(e,n).focus().blur()}catch(e){}return t},getNodes:function(){return data.getNodes(n)},getNodeByParam:function(e,t,i){return e?data.getNodeByParam(n,i?i[n.data.key.children]:data.getNodes(n),e,t):null},getNodeByTId:function(e){return data.getNodeCache(n,e)},getNodesByParam:function(e,t,i){return e?data.getNodesByParam(n,i?i[n.data.key.children]:data.getNodes(n),e,t):null},getNodesByParamFuzzy:function(e,t,i){return e?data.getNodesByParamFuzzy(n,i?i[n.data.key.children]:data.getNodes(n),e,t):null},getNodesByFilter:function(e,t,i,a){return t=!!t,e&&"function"==typeof e?data.getNodesByFilter(n,i?i[n.data.key.children]:data.getNodes(n),e,t,a):t?null:[]},getNodeIndex:function(e){if(!e)return null;for(var t=n.data.key.children,i=e.parentTId?e.getParentNode():data.getRoot(n),a=0,o=i[t].length;a<o;a++)if(i[t][a]==e)return a;return-1},getSelectedNodes:function(){for(var e=[],t=data.getRoot(n).curSelectedList,i=0,a=t.length;i<a;i++)e.push(t[i]);return e},isSelectedNode:function(e){return data.isSelectedNode(n,e)},reAsyncChildNodes:function(e,t,i){if(this.setting.async.enable){var a=!e;if(a&&(e=data.getRoot(n)),"refresh"==t){for(var o=this.setting.data.key.children,s=0,r=e[o]?e[o].length:0;s<r;s++)data.removeNodeCache(n,e[o][s]);data.removeSelectedNode(n),e[o]=[],a?this.setting.treeObj.empty():$$(e,consts.id.UL,n).empty()}view.asyncNode(this.setting,a?null:e,!!i)}},refresh:function(){this.setting.treeObj.empty();var e=data.getRoot(n),t=e[n.data.key.children];data.initRoot(n),e[n.data.key.children]=t,data.initCache(n),view.createNodes(n,0,e[n.data.key.children])},removeChildNodes:function(e){if(!e)return null;var t=e[n.data.key.children];return view.removeChildNodes(n,e),t||null},removeNode:function(e,t){e&&((t=!!t)&&0==tools.apply(n.callback.beforeRemove,[n.treeId,e],!0)||(view.removeNode(n,e),t&&this.setting.treeObj.trigger(consts.event.REMOVE,[n.treeId,e])))},selectNode:function(e,t){if(e&&tools.uCanDo(n)){if(t=n.view.selectedMulti&&t,e.parentTId)view.expandCollapseParentNode(n,e.getParentNode(),!0,!1,function(){try{$$(e,n).focus().blur()}catch(e){}});else try{$$(e,n).focus().blur()}catch(e){}view.selectNode(n,e,t)}},transformTozTreeNodes:function(e){return data.transformTozTreeFormat(n,e)},transformToArray:function(e){return data.transformToArrayFormat(n,e)},updateNode:function(e,t){e&&$$(e,n).get(0)&&tools.uCanDo(n)&&(view.setNodeName(n,e),view.setNodeTarget(n,e),view.setNodeUrl(n,e),view.setNodeLineIcos(n,e),view.setNodeFontCss(n,e))}};return a.treeTools=s,data.setZTreeTools(n,s),a[o]&&a[o].length>0?view.createNodes(n,0,a[o]):n.async.enable&&n.async.url&&""!==n.async.url&&view.asyncNode(n),s}};var zt=$.fn.zTree,$$=tools.$,consts=zt.consts}(jQuery),function(e){var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},i={check:{enable:!1,autoCheckTrigger:!1,chkStyle:t.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},n={onCheckNode:function(e,t){if(!0===t.chkDisabled)return!1;var i=d.getSetting(e.data.treeId),n=i.data.key.checked;if(0==s.apply(i.callback.beforeCheck,[i.treeId,t],!0))return!0;t[n]=!t[n],l.checkNodeRelation(i,t);var a=c(t,r.id.CHECK,i);return l.setChkClass(i,a,t),l.repairParentChkClassWithSelf(i,t),i.treeObj.trigger(r.event.CHECK,[e,i.treeId,t]),!0},onMouseoverCheck:function(e,t){if(!0===t.chkDisabled)return!1;var i=d.getSetting(e.data.treeId),n=c(t,r.id.CHECK,i);return t.check_Focus=!0,l.setChkClass(i,n,t),!0},onMouseoutCheck:function(e,t){if(!0===t.chkDisabled)return!1;var i=d.getSetting(e.data.treeId),n=c(t,r.id.CHECK,i);return t.check_Focus=!1,l.setChkClass(i,n,t),!0}},a={tools:{},view:{checkNodeRelation:function(e,t){var i,n,a,o=e.data.key.children,s=e.data.key.checked,h=r.radio;if(e.check.chkStyle==h.STYLE){var u=d.getRadioCheckedList(e);if(t[s])if(e.check.radioType==h.TYPE_ALL){for(n=u.length-1;n>=0;n--)(i=u[n])[s]&&i!=t&&(i[s]=!1,u.splice(n,1),l.setChkClass(e,c(i,r.id.CHECK,e),i),i.parentTId!=t.parentTId&&l.repairParentChkClassWithSelf(e,i));u.push(t)}else{var p=t.parentTId?t.getParentNode():d.getRoot(e);for(n=0,a=p[o].length;n<a;n++)(i=p[o][n])[s]&&i!=t&&(i[s]=!1,l.setChkClass(e,c(i,r.id.CHECK,e),i))}else if(e.check.radioType==h.TYPE_ALL)for(n=0,a=u.length;n<a;n++)if(t==u[n]){u.splice(n,1);break}}else t[s]&&(!t[o]||0==t[o].length||e.check.chkboxType.Y.indexOf("s")>-1)&&l.setSonNodeCheckBox(e,t,!0),t[s]||t[o]&&0!=t[o].length&&!(e.check.chkboxType.N.indexOf("s")>-1)||l.setSonNodeCheckBox(e,t,!1),t[s]&&e.check.chkboxType.Y.indexOf("p")>-1&&l.setParentNodeCheckBox(e,t,!0),!t[s]&&e.check.chkboxType.N.indexOf("p")>-1&&l.setParentNodeCheckBox(e,t,!1)},makeChkClass:function(e,t){var i=e.data.key.checked,n=r.checkbox,a=r.radio,o="";o=!0===t.chkDisabled?n.DISABLED:t.halfCheck?n.PART:e.check.chkStyle==a.STYLE?t.check_Child_State<1?n.FULL:n.PART:t[i]?2===t.check_Child_State||-1===t.check_Child_State?n.FULL:n.PART:t.check_Child_State<1?n.FULL:n.PART;var s=e.check.chkStyle+"_"+(t[i]?n.TRUE:n.FALSE)+"_"+o;return s=t.check_Focus&&!0!==t.chkDisabled?s+"_"+n.FOCUS:s,r.className.BUTTON+" "+n.DEFAULT+" "+s},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===r.checkbox.STYLE)for(var i=e.data.key.checked,n=e.data.key.children,a=d.getRoot(e),o=0,s=a[n].length;o<s;o++){var c=a[n][o];!0!==c.nocheck&&!0!==c.chkDisabled&&(c[i]=t),l.setSonNodeCheckBox(e,c,t)}},repairChkClass:function(e,t){if(t&&(d.makeChkFlag(e,t),!0!==t.nocheck)){var i=c(t,r.id.CHECK,e);l.setChkClass(e,i,t)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var i=t.getParentNode();l.repairChkClass(e,i),l.repairParentChkClass(e,i)}},repairParentChkClassWithSelf:function(e,t){if(t){var i=e.data.key.children;t[i]&&t[i].length>0?l.repairParentChkClass(e,t[i][0]):l.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,i,n){if(t){var a=e.data.key.children;if(t.chkDisabled!=i&&(t.chkDisabled=i),l.repairChkClass(e,t),t[a]&&n)for(var o=0,s=t[a].length;o<s;o++){var r=t[a][o];l.repairSonChkDisabled(e,r,i,n)}}},repairParentChkDisabled:function(e,t,i,n){t&&(t.chkDisabled!=i&&n&&(t.chkDisabled=i),l.repairChkClass(e,t),l.repairParentChkDisabled(e,t.getParentNode(),i,n))},setChkClass:function(e,t,i){t&&(!0===i.nocheck?t.hide():t.show(),t.attr("class",l.makeChkClass(e,i)))},setParentNodeCheckBox:function(e,t,i,n){var a=e.data.key.children,o=e.data.key.checked,s=c(t,r.id.CHECK,e);if(n||(n=t),d.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled&&(t[o]=i,l.setChkClass(e,s,t),e.check.autoCheckTrigger&&t!=n&&e.treeObj.trigger(r.event.CHECK,[null,e.treeId,t])),t.parentTId){var h=!0;if(!i)for(var u=t.getParentNode()[a],p=0,f=u.length;p<f;p++)if(!0!==u[p].nocheck&&!0!==u[p].chkDisabled&&u[p][o]||(!0===u[p].nocheck||!0===u[p].chkDisabled)&&u[p].check_Child_State>0){h=!1;break}h&&l.setParentNodeCheckBox(e,t.getParentNode(),i,n)}},setSonNodeCheckBox:function(e,t,i,n){if(t){var a=e.data.key.children,o=e.data.key.checked,s=c(t,r.id.CHECK,e);n||(n=t);var h=!1;if(t[a])for(var u=0,p=t[a].length;u<p&&!0!==t.chkDisabled;u++){var f=t[a][u];l.setSonNodeCheckBox(e,f,i,n),!0===f.chkDisabled&&(h=!0)}t!=d.getRoot(e)&&!0!==t.chkDisabled&&(h&&!0!==t.nocheck&&d.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled?(t[o]=i,h||(t.check_Child_State=t[a]&&t[a].length>0?i?2:0:-1)):t.check_Child_State=-1,l.setChkClass(e,s,t),e.check.autoCheckTrigger&&t!=n&&!0!==t.nocheck&&!0!==t.chkDisabled&&e.treeObj.trigger(r.event.CHECK,[null,e.treeId,t]))}}},event:{},data:{getRadioCheckedList:function(e){for(var t=d.getRoot(e).radioCheckedList,i=0,n=t.length;i<n;i++)d.getNodeCache(e,t[i].tId)||(t.splice(i,1),i--,n--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var i=e.data.key.checked;return{checked:t[i],half:t.halfCheck?t.halfCheck:e.check.chkStyle==r.radio.STYLE?2===t.check_Child_State:t[i]?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0}},getTreeCheckedNodes:function(e,t,i,n){if(!t)return[];var a=e.data.key.children,o=e.data.key.checked,s=i&&e.check.chkStyle==r.radio.STYLE&&e.check.radioType==r.radio.TYPE_ALL;n=n||[];for(var l=0,c=t.length;l<c&&(!0===t[l].nocheck||!0===t[l].chkDisabled||t[l][o]!=i||(n.push(t[l]),!s))&&(d.getTreeCheckedNodes(e,t[l][a],i,n),!(s&&n.length>0));l++);return n},getTreeChangeCheckedNodes:function(e,t,i){if(!t)return[];var n=e.data.key.children,a=e.data.key.checked;i=i||[];for(var o=0,s=t.length;o<s;o++)!0!==t[o].nocheck&&!0!==t[o].chkDisabled&&t[o][a]!=t[o].checkedOld&&i.push(t[o]),d.getTreeChangeCheckedNodes(e,t[o][n],i);return i},makeChkFlag:function(e,t){if(t){var i=e.data.key.children,n=e.data.key.checked,a=-1;if(t[i])for(var o=0,s=t[i].length;o<s;o++){var l=t[i][o],d=-1;if(e.check.chkStyle==r.radio.STYLE){if(2==(d=!0===l.nocheck||!0===l.chkDisabled?l.check_Child_State:!0===l.halfCheck?2:l[n]?2:l.check_Child_State>0?2:0)){a=2;break}0==d&&(a=0)}else if(e.check.chkStyle==r.checkbox.STYLE){if(1===(d=!0===l.nocheck||!0===l.chkDisabled?l.check_Child_State:!0===l.halfCheck?1:l[n]?-1===l.check_Child_State||2===l.check_Child_State?2:1:l.check_Child_State>0?1:0)){a=1;break}if(2===d&&a>-1&&o>0&&d!==a){a=1;break}if(2===a&&d>-1&&d<2){a=1;break}d>-1&&(a=d)}}t.check_Child_State=a}}}};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,a);var o=e.fn.zTree,s=o._z.tools,r=o.consts,l=o._z.view,d=o._z.data,c=(o._z.event,s.$);d.exSetting(i),d.addInitBind(function(e){var t=e.treeObj,i=r.event;t.bind(i.CHECK,function(t,i,n,a){t.srcEvent=i,s.apply(e.callback.onCheck,[t,n,a])})}),d.addInitUnBind(function(e){var t=e.treeObj,i=r.event;t.unbind(i.CHECK)}),d.addInitCache(function(e){}),d.addInitNode(function(e,t,i,n,a,o,l){if(i){var c=e.data.key.checked;"string"==typeof i[c]&&(i[c]=s.eqs(i[c],"true")),i[c]=!!i[c],i.checkedOld=i[c],"string"==typeof i.nocheck&&(i.nocheck=s.eqs(i.nocheck,"true")),i.nocheck=!!i.nocheck||e.check.nocheckInherit&&n&&!!n.nocheck,"string"==typeof i.chkDisabled&&(i.chkDisabled=s.eqs(i.chkDisabled,"true")),i.chkDisabled=!!i.chkDisabled||e.check.chkDisabledInherit&&n&&!!n.chkDisabled,"string"==typeof i.halfCheck&&(i.halfCheck=s.eqs(i.halfCheck,"true")),i.halfCheck=!!i.halfCheck,i.check_Child_State=-1,i.check_Focus=!1,i.getCheckStatus=function(){return d.getCheckStatus(e,i)},e.check.chkStyle==r.radio.STYLE&&e.check.radioType==r.radio.TYPE_ALL&&i[c]&&d.getRoot(e).radioCheckedList.push(i)}}),d.addInitProxy(function(e){var t=e.target,i=d.getSetting(e.data.treeId),a="",o=null,l="",c=null;if(s.eqs(e.type,"mouseover")?i.check.enable&&s.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+r.id.CHECK)&&(a=s.getNodeMainDom(t).id,l="mouseoverCheck"):s.eqs(e.type,"mouseout")?i.check.enable&&s.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+r.id.CHECK)&&(a=s.getNodeMainDom(t).id,l="mouseoutCheck"):s.eqs(e.type,"click")&&i.check.enable&&s.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+r.id.CHECK)&&(a=s.getNodeMainDom(t).id,l="checkNode"),a.length>0)switch(o=d.getNodeCache(i,a),l){case"checkNode":c=n.onCheckNode;break;case"mouseoverCheck":c=n.onMouseoverCheck;break;case"mouseoutCheck":c=n.onMouseoutCheck}return{stop:"checkNode"===l,node:o,nodeEventType:l,nodeEventCallback:c,treeEventType:"",treeEventCallback:null}},!0),d.addInitRoot(function(e){d.getRoot(e).radioCheckedList=[]}),d.addBeforeA(function(e,t,i){e.data.key.checked;e.check.enable&&(d.makeChkFlag(e,t),i.push("<span ID='",t.tId,r.id.CHECK,"' class='",l.makeChkClass(e,t),"' treeNode",r.id.CHECK,!0===t.nocheck?" style='display:none;'":"","></span>"))}),d.addZTreeTools(function(e,t){t.checkNode=function(e,t,i,n){var a=this.setting.data.key.checked;if(!0!==e.chkDisabled&&(!0!==t&&!1!==t&&(t=!e[a]),n=!!n,(e[a]!==t||i)&&(!n||0!=s.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0))&&s.uCanDo(this.setting)&&this.setting.check.enable&&!0!==e.nocheck)){e[a]=t;var o=c(e,r.id.CHECK,this.setting);(i||this.setting.check.chkStyle===r.radio.STYLE)&&l.checkNodeRelation(this.setting,e),l.setChkClass(this.setting,o,e),l.repairParentChkClassWithSelf(this.setting,e),n&&this.setting.treeObj.trigger(r.event.CHECK,[null,this.setting.treeId,e])}},t.checkAllNodes=function(e){l.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(e){var t=this.setting.data.key.children;return e=!1!==e,d.getTreeCheckedNodes(this.setting,d.getRoot(this.setting)[t],e)},t.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return d.getTreeChangeCheckedNodes(this.setting,d.getRoot(this.setting)[e])},t.setChkDisabled=function(e,t,i,n){t=!!t,i=!!i,n=!!n,l.repairSonChkDisabled(this.setting,e,t,n),l.repairParentChkDisabled(this.setting,e.getParentNode(),t,i)};var i=t.updateNode;t.updateNode=function(e,n){if(i&&i.apply(t,arguments),e&&this.setting.check.enable&&c(e,this.setting).get(0)&&s.uCanDo(this.setting)){var a=c(e,r.id.CHECK,this.setting);1!=n&&this.setting.check.chkStyle!==r.radio.STYLE||l.checkNodeRelation(this.setting,e),l.setChkClass(this.setting,a,e),l.repairParentChkClassWithSelf(this.setting,e)}}});var h=l.createNodes;l.createNodes=function(e,t,i,n){h&&h.apply(l,arguments),i&&l.repairParentChkClassWithSelf(e,n)};var u=l.removeNode;l.removeNode=function(e,t){var i=t.getParentNode();u&&u.apply(l,arguments),t&&i&&(l.repairChkClass(e,i),l.repairParentChkClass(e,i))};var p=l.appendNodes;l.appendNodes=function(e,t,i,n,a,o){var s="";return p&&(s=p.apply(l,arguments)),n&&d.makeChkFlag(e,n),s}}(jQuery),function(e){var t={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},i={edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"删除",renameTitle:"修改",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}},n={onHoverOverNode:function(e,t){var i=d.getSetting(e.data.treeId),a=d.getRoot(i);a.curHoverNode!=t&&n.onHoverOutNode(e),a.curHoverNode=t,l.addHoverDom(i,t)},onHoverOutNode:function(e,t){var i=d.getSetting(e.data.treeId),n=d.getRoot(i);n.curHoverNode&&!d.isSelectedNode(i,n.curHoverNode)&&(l.removeTreeDom(i,n.curHoverNode),n.curHoverNode=null)},onMousedownNode:function(i,n){function a(i){if(0==g.dragFlag&&Math.abs(R-i.clientX)<f.edit.drag.minMoveSize&&Math.abs(A-i.clientY)<f.edit.drag.minMoveSize)return!0;var n,a,h,u,p,m=f.data.key.children;if(D.css("cursor","pointer"),0==g.dragFlag){if(0==s.apply(f.callback.beforeDrag,[f.treeId,y],!0))return o(i),!0;for(n=0,a=y.length;n<a;n++)0==n&&(g.dragNodeShowBefore=[]),(h=y[n]).isParent&&h.open?(l.expandCollapseNode(f,h,!h.open),g.dragNodeShowBefore[h.tId]=!0):g.dragNodeShowBefore[h.tId]=!1;g.dragFlag=1,v.showHoverDom=!1,s.showIfameMask(f,!0);var b=!0,I=-1;if(y.length>1){var M=y[0].parentTId?y[0].getParentNode()[m]:d.getNodes(f);for(p=[],n=0,a=M.length;n<a;n++)if(void 0!==g.dragNodeShowBefore[M[n].tId]&&(b&&I>-1&&I+1!==n&&(b=!1),p.push(M[n]),I=n),y.length===p.length){y=p;break}}for(b&&(w=y[0].getPreNode(),T=y[y.length-1].getNextNode()),N=c("<ul class='zTreeDragUL'></ul>",f),n=0,a=y.length;n<a;n++)(h=y[n]).editNameFlag=!1,l.selectNode(f,h,n>0),l.removeTreeDom(f,h),n>f.edit.drag.maxShowNodeNum-1||((u=c("<li id='"+h.tId+"_tmp'></li>",f)).append(c(h,r.id.A,f).clone()),u.css("padding","0"),u.children("#"+h.tId+r.id.A).removeClass(r.node.CURSELECTED),N.append(u),n==f.edit.drag.maxShowNodeNum-1&&(u=c("<li id='"+h.tId+"_moretmp'><a>  ...  </a></li>",f),N.append(u)));N.attr("id",y[0].tId+r.id.UL+"_tmp"),N.addClass(f.treeObj.attr("class")),N.appendTo(D),(C=c("<span class='tmpzTreeMove_arrow'></span>",f)).attr("id","zTreeMove_arrow_tmp"),C.appendTo(D),f.treeObj.trigger(r.event.DRAG,[i,f.treeId,y])}if(1==g.dragFlag){if(k&&C.attr("id")==i.target.id&&L&&i.clientX+x.scrollLeft()+2>e("#"+L+r.id.A,k).offset().left){var j=e("#"+L+r.id.A,k);i.target=j.length>0?j.get(0):i.target}else k&&(k.removeClass(r.node.TMPTARGET_TREE),L&&e("#"+L+r.id.A,k).removeClass(r.node.TMPTARGET_NODE+"_"+r.move.TYPE_PREV).removeClass(r.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(r.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER));k=null,L=null,_=!1,E=f;var z=d.getSettings();for(var B in z)z[B].treeId&&z[B].edit.enable&&z[B].treeId!=f.treeId&&(i.target.id==z[B].treeId||e(i.target).parents("#"+z[B].treeId).length>0)&&(_=!0,E=z[B]);var H=x.scrollTop(),$=x.scrollLeft(),Y=E.treeObj.offset(),W=E.treeObj.get(0).scrollHeight,U=E.treeObj.get(0).scrollWidth,q=i.clientY+H-Y.top,K=E.treeObj.height()+Y.top-i.clientY-H,V=i.clientX+$-Y.left,G=E.treeObj.width()+Y.left-i.clientX-$,X=q<f.edit.drag.borderMax&&q>f.edit.drag.borderMin,Q=K<f.edit.drag.borderMax&&K>f.edit.drag.borderMin,Z=V<f.edit.drag.borderMax&&V>f.edit.drag.borderMin,J=G<f.edit.drag.borderMax&&G>f.edit.drag.borderMin,ee=q>f.edit.drag.borderMin&&K>f.edit.drag.borderMin&&V>f.edit.drag.borderMin&&G>f.edit.drag.borderMin,te=X&&E.treeObj.scrollTop()<=0,ie=Q&&E.treeObj.scrollTop()+E.treeObj.height()+10>=W,ne=Z&&E.treeObj.scrollLeft()<=0,ae=J&&E.treeObj.scrollLeft()+E.treeObj.width()+10>=U;if(i.target&&s.isChildOrSelf(i.target,E.treeId)){for(var oe=i.target;oe&&oe.tagName&&!s.eqs(oe.tagName,"li")&&oe.id!=E.treeId;)oe=oe.parentNode;var se=!0;for(n=0,a=y.length;n<a;n++){if(h=y[n],oe.id===h.tId){se=!1;break}if(c(h,f).find("#"+oe.id).length>0){se=!1;break}}se&&i.target&&s.isChildOrSelf(i.target,oe.id+r.id.A)&&(k=e(oe),L=oe.id)}h=y[0],ee&&s.isChildOrSelf(i.target,E.treeId)&&(!k&&(i.target.id==E.treeId||te||ie||ne||ae)&&(_||!_&&h.parentTId)&&(k=E.treeObj),X?E.treeObj.scrollTop(E.treeObj.scrollTop()-10):Q&&E.treeObj.scrollTop(E.treeObj.scrollTop()+10),Z?E.treeObj.scrollLeft(E.treeObj.scrollLeft()-10):J&&E.treeObj.scrollLeft(E.treeObj.scrollLeft()+10),k&&k!=E.treeObj&&k.offset().left<E.treeObj.offset().left&&E.treeObj.scrollLeft(E.treeObj.scrollLeft()+k.offset().left-E.treeObj.offset().left)),N.css({top:i.clientY+H+3+"px",left:i.clientX+$+3+"px"});var re=0,le=0;if(k&&k.attr("id")!=E.treeId){var de=null==L?null:d.getNodeCache(E,L),ce=(i.ctrlKey||i.metaKey)&&f.edit.drag.isMove&&f.edit.drag.isCopy||!f.edit.drag.isMove&&f.edit.drag.isCopy,he=!(!w||L!==w.tId),ue=!(!T||L!==T.tId),pe=h.parentTId&&h.parentTId==L,fe=(ce||!ue)&&s.apply(E.edit.drag.prev,[E.treeId,y,de],!!E.edit.drag.prev),ge=(ce||!he)&&s.apply(E.edit.drag.next,[E.treeId,y,de],!!E.edit.drag.next),ve=(ce||!pe)&&!(E.data.keep.leaf&&!de.isParent)&&s.apply(E.edit.drag.inner,[E.treeId,y,de],!!E.edit.drag.inner);if(fe||ge||ve){var me=e("#"+L+r.id.A,k),be=de.isLastNode?null:e("#"+de.getNextNode().tId+r.id.A,k.next()),ye=me.offset().top,Ne=me.offset().left,Ce=fe?ve?.25:ge?.5:1:-1,ke=ge?ve?.75:fe?.5:0:-1,we=(i.clientY+H-ye)/me.height();if((1==Ce||we<=Ce&&we>=-.2)&&fe?(re=1-C.width(),le=ye-C.height()/2,P=r.move.TYPE_PREV):(0==ke||we>=ke&&we<=1.2)&&ge?(re=1-C.width(),le=null==be||de.isParent&&de.open?ye+me.height()-C.height()/2:be.offset().top-C.height()/2,P=r.move.TYPE_NEXT):(re=5-C.width(),le=ye,P=r.move.TYPE_INNER),C.css({display:"block",top:le+"px",left:Ne+re+"px"}),me.addClass(r.node.TMPTARGET_NODE+"_"+P),F==L&&S==P||(O=(new Date).getTime()),de&&de.isParent&&P==r.move.TYPE_INNER){var Te=!0;window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==de.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===de.tId&&(Te=!1),Te&&(window.zTreeMoveTimer=setTimeout(function(){P==r.move.TYPE_INNER&&de&&de.isParent&&!de.open&&(new Date).getTime()-O>E.edit.drag.autoOpenTime&&s.apply(E.callback.beforeDragOpen,[E.treeId,de],!0)&&(l.switchNode(E,de),E.edit.drag.autoExpandTrigger&&E.treeObj.trigger(r.event.EXPAND,[E.treeId,de]))},E.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=de.tId)}}else k=null,L="",P=r.move.TYPE_INNER,C.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}else P=r.move.TYPE_INNER,k&&s.apply(E.edit.drag.inner,[E.treeId,y,null],!!E.edit.drag.inner)?k.addClass(r.node.TMPTARGET_TREE):k=null,C.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);F=L,S=P,f.treeObj.trigger(r.event.DRAGMOVE,[i,f.treeId,y])}return!1}function o(i){function n(){if(_){if(!b)for(var e=0,t=y.length;e<t;e++)l.removeNode(f,y[e]);if(P==r.move.TYPE_INNER)l.addNodes(E,w,T);else if(l.addNodes(E,w.getParentNode(),T),P==r.move.TYPE_PREV)for(e=0,t=T.length;e<t;e++)l.moveNode(E,w,T[e],P,!1);else for(e=-1,t=T.length-1;e<t;t--)l.moveNode(E,w,T[t],P,!1)}else if(b&&P==r.move.TYPE_INNER)l.addNodes(E,w,T);else if(b&&l.addNodes(E,w.getParentNode(),T),P!=r.move.TYPE_NEXT)for(e=0,t=T.length;e<t;e++)l.moveNode(E,w,T[e],P,!1);else for(e=-1,t=T.length-1;e<t;t--)l.moveNode(E,w,T[t],P,!1);l.selectNodes(E,T),c(T[0],f).focus().blur(),f.treeObj.trigger(r.event.DROP,[i,E.treeId,T,w,P,b])}if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),F=null,S=null,x.unbind("mousemove",a),x.unbind("mouseup",o),x.unbind("selectstart",h),D.css("cursor","auto"),k&&(k.removeClass(r.node.TMPTARGET_TREE),L&&e("#"+L+r.id.A,k).removeClass(r.node.TMPTARGET_NODE+"_"+r.move.TYPE_PREV).removeClass(r.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(r.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)),s.showIfameMask(f,!1),v.showHoverDom=!0,0!=g.dragFlag){g.dragFlag=0;var u,p,m;for(u=0,p=y.length;u<p;u++)(m=y[u]).isParent&&g.dragNodeShowBefore[m.tId]&&!m.open&&(l.expandCollapseNode(f,m,!m.open),delete g.dragNodeShowBefore[m.tId]);N&&N.remove(),C&&C.remove();var b=(i.ctrlKey||i.metaKey)&&f.edit.drag.isMove&&f.edit.drag.isCopy||!f.edit.drag.isMove&&f.edit.drag.isCopy;if(!b&&k&&L&&y[0].parentTId&&L==y[0].parentTId&&P==r.move.TYPE_INNER&&(k=null),k){var w=null==L?null:d.getNodeCache(E,L);if(0==s.apply(f.callback.beforeDrop,[E.treeId,y,w,P,b],!0))return void l.selectNodes(I,y);var T=b?s.clone(y):y;P==r.move.TYPE_INNER&&s.canAsync(E,w)?l.asyncNode(E,w,!1,n):n()}else l.selectNodes(I,y),f.treeObj.trigger(r.event.DROP,[i,f.treeId,y,null,null,null])}}function h(){return!1}var u,p,f=d.getSetting(i.data.treeId),g=d.getRoot(f),v=d.getRoots();if(2==i.button||!f.edit.enable||!f.edit.drag.isCopy&&!f.edit.drag.isMove)return!0;var m=i.target,b=d.getRoot(f).curSelectedList,y=[];if(d.isSelectedNode(f,n))for(u=0,p=b.length;u<p;u++){if(b[u].editNameFlag&&s.eqs(m.tagName,"input")&&null!==m.getAttribute("treeNode"+r.id.INPUT))return!0;if(y.push(b[u]),y[0].parentTId!==b[u].parentTId){y=[n];break}}else y=[n];l.editNodeBlur=!0,l.cancelCurEditNode(f);var N,C,k,w,T,x=e(f.treeObj.get(0).ownerDocument),D=e(f.treeObj.get(0).ownerDocument.body),_=!1,E=f,I=f,F=null,S=null,L=null,P=r.move.TYPE_INNER,R=i.clientX,A=i.clientY,O=(new Date).getTime();return s.uCanDo(f)&&x.bind("mousemove",a),x.bind("mouseup",o),x.bind("selectstart",h),i.preventDefault&&i.preventDefault(),!0}},a={tools:{getAbs:function(e){var t=e.getBoundingClientRect(),i=document.body.scrollTop+document.documentElement.scrollTop,n=document.body.scrollLeft+document.documentElement.scrollLeft;return[t.left+n,t.top+i]},inputFocus:function(e){e.get(0)&&(e.focus(),s.setCursorPosition(e.get(0),e.val().length))},inputSelect:function(e){e.get(0)&&(e.focus(),e.select())},setCursorPosition:function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}},showIfameMask:function(e,t){for(var i=d.getRoot(e);i.dragMaskList.length>0;)i.dragMaskList[0].remove(),i.dragMaskList.shift();if(t)for(var n=c("iframe",e),a=0,o=n.length;a<o;a++){var r=n.get(a),l=s.getAbs(r),h=c("<div id='zTreeMask_"+a+"' class='zTreeMask' style='top:"+l[1]+"px; left:"+l[0]+"px; width:"+r.offsetWidth+"px; height:"+r.offsetHeight+"px;'></div>",e);h.appendTo(c("body",e)),i.dragMaskList.push(h)}}},view:{addEditBtn:function(e,t){if(!(t.editNameFlag||c(t,r.id.EDIT,e).length>0)&&s.apply(e.edit.showRenameBtn,[e.treeId,t],e.edit.showRenameBtn)){var i=c(t,r.id.A,e),n="<span class='"+r.className.BUTTON+" edit' id='"+t.tId+r.id.EDIT+"' title='"+s.apply(e.edit.renameTitle,[e.treeId,t],e.edit.renameTitle)+"' treeNode"+r.id.EDIT+" style='display:none;'></span>";i.append(n),c(t,r.id.EDIT,e).bind("click",function(){return!(!s.uCanDo(e)||0==s.apply(e.callback.beforeEditName,[e.treeId,t],!0))&&(l.editNode(e,t),!1)}).show()}},addRemoveBtn:function(e,t){if(!(t.editNameFlag||c(t,r.id.REMOVE,e).length>0)&&s.apply(e.edit.showRemoveBtn,[e.treeId,t],e.edit.showRemoveBtn)){var i=c(t,r.id.A,e),n="<span class='"+r.className.BUTTON+" remove' id='"+t.tId+r.id.REMOVE+"' title='"+s.apply(e.edit.removeTitle,[e.treeId,t],e.edit.removeTitle)+"' treeNode"+r.id.REMOVE+" style='display:none;'></span>";i.append(n),c(t,r.id.REMOVE,e).bind("click",function(){return!(!s.uCanDo(e)||0==s.apply(e.callback.beforeRemove,[e.treeId,t],!0))&&(l.removeNode(e,t),e.treeObj.trigger(r.event.REMOVE,[e.treeId,t]),!1)}).bind("mousedown",function(e){return!0}).show()}},addHoverDom:function(e,t){d.getRoots().showHoverDom&&(t.isHover=!0,e.edit.enable&&(l.addEditBtn(e,t),l.addRemoveBtn(e,t)),s.apply(e.view.addHoverDom,[e.treeId,t]))},cancelCurEditNode:function(e,t,i){var n=d.getRoot(e),a=e.data.key.name,o=n.curEditNode;if(o){var h=n.curEditInput,u=t||(i?o[a]:h.val());if(!1===s.apply(e.callback.beforeRename,[e.treeId,o,u,i],!0))return!1;o[a]=u,e.treeObj.trigger(r.event.RENAME,[e.treeId,o,i]),c(o,r.id.A,e).removeClass(r.node.CURSELECTED_EDIT),h.unbind(),l.setNodeName(e,o),o.editNameFlag=!1,n.curEditNode=null,n.curEditInput=null,l.selectNode(e,o,!1)}return n.noSelection=!0,!0},editNode:function(e,t){var i=d.getRoot(e);if(l.editNodeBlur=!1,d.isSelectedNode(e,t)&&i.curEditNode==t&&t.editNameFlag)setTimeout(function(){s.inputFocus(i.curEditInput)},0);else{var n=e.data.key.name;t.editNameFlag=!0,l.removeTreeDom(e,t),l.cancelCurEditNode(e),l.selectNode(e,t,!1),c(t,r.id.SPAN,e).html("<input type=text class='rename' id='"+t.tId+r.id.INPUT+"' treeNode"+r.id.INPUT+" >");var a=c(t,r.id.INPUT,e);a.attr("value",t[n]),e.edit.editNameSelectAll?s.inputSelect(a):s.inputFocus(a),a.bind("blur",function(t){l.editNodeBlur||l.cancelCurEditNode(e)}).bind("keydown",function(t){"13"==t.keyCode?(l.editNodeBlur=!0,l.cancelCurEditNode(e)):"27"==t.keyCode&&l.cancelCurEditNode(e,null,!0)}).bind("click",function(e){return!1}).bind("dblclick",function(e){return!1}),c(t,r.id.A,e).addClass(r.node.CURSELECTED_EDIT),i.curEditInput=a,i.noSelection=!1,i.curEditNode=t}},moveNode:function(e,t,i,n,a,o){var s=d.getRoot(e),h=e.data.key.children;if(t!=i&&(!e.data.keep.leaf||!t||t.isParent||n!=r.move.TYPE_INNER)){var u=i.parentTId?i.getParentNode():s,p=null===t||t==s;p&&null===t&&(t=s),p&&(n=r.move.TYPE_INNER);var f=t.parentTId?t.getParentNode():s;n!=r.move.TYPE_PREV&&n!=r.move.TYPE_NEXT&&(n=r.move.TYPE_INNER),n==r.move.TYPE_INNER&&(p?i.parentTId=null:(t.isParent||(t.isParent=!0,t.open=!!t.open,l.setNodeLineIcos(e,t)),i.parentTId=t.tId));var g,v;if(p)v=g=e.treeObj;else{if(o||n!=r.move.TYPE_INNER?o||l.expandCollapseNode(e,t.getParentNode(),!0,!1):l.expandCollapseNode(e,t,!0,!1),g=c(t,e),v=c(t,r.id.UL,e),g.get(0)&&!v.get(0)){var m=[];l.makeUlHtml(e,t,m,""),g.append(m.join(""))}v=c(t,r.id.UL,e)}var b=c(i,e);b.get(0)?g.get(0)||b.remove():b=l.appendNodes(e,i.level,[i],null,!1,!0).join(""),v.get(0)&&n==r.move.TYPE_INNER?v.append(b):g.get(0)&&n==r.move.TYPE_PREV?g.before(b):g.get(0)&&n==r.move.TYPE_NEXT&&g.after(b);var y,N,C=-1,k=0,w=null,T=null,x=i.level;if(i.isFirstNode)C=0,u[h].length>1&&((w=u[h][1]).isFirstNode=!0);else if(i.isLastNode)C=u[h].length-1,(w=u[h][C-1]).isLastNode=!0;else for(y=0,N=u[h].length;y<N;y++)if(u[h][y].tId==i.tId){C=y;break}if(C>=0&&u[h].splice(C,1),n!=r.move.TYPE_INNER)for(y=0,N=f[h].length;y<N;y++)f[h][y].tId==t.tId&&(k=y);if(n==r.move.TYPE_INNER?(t[h]||(t[h]=new Array),t[h].length>0&&((T=t[h][t[h].length-1]).isLastNode=!1),t[h].splice(t[h].length,0,i),i.isLastNode=!0,i.isFirstNode=1==t[h].length):t.isFirstNode&&n==r.move.TYPE_PREV?(f[h].splice(k,0,i),(T=t).isFirstNode=!1,i.parentTId=t.parentTId,i.isFirstNode=!0,i.isLastNode=!1):t.isLastNode&&n==r.move.TYPE_NEXT?(f[h].splice(k+1,0,i),(T=t).isLastNode=!1,i.parentTId=t.parentTId,i.isFirstNode=!1,i.isLastNode=!0):(n==r.move.TYPE_PREV?f[h].splice(k,0,i):f[h].splice(k+1,0,i),i.parentTId=t.parentTId,i.isFirstNode=!1,i.isLastNode=!1),d.fixPIdKeyValue(e,i),d.setSonNodeLevel(e,i.getParentNode(),i),l.setNodeLineIcos(e,i),l.repairNodeLevelClass(e,i,x),!e.data.keep.parent&&u[h].length<1){u.isParent=!1,u.open=!1;var D=c(u,r.id.UL,e),_=c(u,r.id.SWITCH,e),E=c(u,r.id.ICON,e);l.replaceSwitchClass(u,_,r.folder.DOCU),l.replaceIcoClass(u,E,r.folder.DOCU),D.css("display","none")}else w&&l.setNodeLineIcos(e,w);T&&l.setNodeLineIcos(e,T),e.check&&e.check.enable&&l.repairChkClass&&(l.repairChkClass(e,u),l.repairParentChkClassWithSelf(e,u),u!=i.parent&&l.repairParentChkClassWithSelf(e,i)),o||l.expandCollapseParentNode(e,i.getParentNode(),!0,a)}},removeEditBtn:function(e,t){c(t,r.id.EDIT,e).unbind().remove()},removeRemoveBtn:function(e,t){c(t,r.id.REMOVE,e).unbind().remove()},removeTreeDom:function(e,t){t.isHover=!1,l.removeEditBtn(e,t),l.removeRemoveBtn(e,t),s.apply(e.view.removeHoverDom,[e.treeId,t])},repairNodeLevelClass:function(e,t,i){if(i!==t.level){var n=c(t,e),a=c(t,r.id.A,e),o=c(t,r.id.UL,e),s=r.className.LEVEL+i,l=r.className.LEVEL+t.level;n.removeClass(s),n.addClass(l),a.removeClass(s),a.addClass(l),o.removeClass(s),o.addClass(l)}},selectNodes:function(e,t){for(var i=0,n=t.length;i<n;i++)l.selectNode(e,t[i],i>0)}},event:{},data:{setSonNodeLevel:function(e,t,i){if(i){var n=e.data.key.children;if(i.level=t?t.level+1:0,i[n])for(var a=0,o=i[n].length;a<o;a++)i[n][a]&&d.setSonNodeLevel(e,i,i[n][a])}}}};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,a);var o=e.fn.zTree,s=o._z.tools,r=o.consts,l=o._z.view,d=o._z.data,c=(o._z.event,s.$);d.exSetting(i),d.addInitBind(function(e){var t=e.treeObj,i=r.event;t.bind(i.RENAME,function(t,i,n,a){s.apply(e.callback.onRename,[t,i,n,a])}),t.bind(i.DRAG,function(t,i,n,a){s.apply(e.callback.onDrag,[i,n,a])}),t.bind(i.DRAGMOVE,function(t,i,n,a){s.apply(e.callback.onDragMove,[i,n,a])}),t.bind(i.DROP,function(t,i,n,a,o,r,l){s.apply(e.callback.onDrop,[i,n,a,o,r,l])})}),d.addInitUnBind(function(e){var t=e.treeObj,i=r.event;t.unbind(i.RENAME),t.unbind(i.DRAG),t.unbind(i.DRAGMOVE),t.unbind(i.DROP)}),d.addInitCache(function(e){}),d.addInitNode(function(e,t,i,n,a,o,s){i&&(i.isHover=!1,i.editNameFlag=!1)}),d.addInitProxy(function(e){var t=e.target,i=d.getSetting(e.data.treeId),a=e.relatedTarget,o="",l=null,c="",h=null,u=null;if(s.eqs(e.type,"mouseover")?(u=s.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+r.id.A}]))&&(o=s.getNodeMainDom(u).id,c="hoverOverNode"):s.eqs(e.type,"mouseout")?(u=s.getMDom(i,a,[{tagName:"a",attrName:"treeNode"+r.id.A}]))||(o="remove",c="hoverOutNode"):s.eqs(e.type,"mousedown")&&(u=s.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+r.id.A}]))&&(o=s.getNodeMainDom(u).id,c="mousedownNode"),o.length>0)switch(l=d.getNodeCache(i,o),c){case"mousedownNode":h=n.onMousedownNode;break;case"hoverOverNode":h=n.onHoverOverNode;break;case"hoverOutNode":h=n.onHoverOutNode}return{stop:!1,node:l,nodeEventType:c,nodeEventCallback:h,treeEventType:"",treeEventCallback:null}}),d.addInitRoot(function(e){var t=d.getRoot(e),i=d.getRoots();t.curEditNode=null,t.curEditInput=null,t.curHoverNode=null,t.dragFlag=0,t.dragNodeShowBefore=[],t.dragMaskList=new Array,i.showHoverDom=!0}),d.addZTreeTools(function(e,t){t.cancelEditName=function(e){d.getRoot(this.setting).curEditNode&&l.cancelCurEditNode(this.setting,e||null,!0)},t.copyNode=function(e,t,i,n){function a(){l.addNodes(o.setting,e,[d],n)}if(!t)return null;if(e&&!e.isParent&&this.setting.data.keep.leaf&&i===r.move.TYPE_INNER)return null;var o=this,d=s.clone(t);return e||(e=null,i=r.move.TYPE_INNER),i==r.move.TYPE_INNER?s.canAsync(this.setting,e)?l.asyncNode(this.setting,e,n,a):a():(l.addNodes(this.setting,e.parentNode,[d],n),l.moveNode(this.setting,e,d,i,!1,n)),d},t.editName=function(e){e&&e.tId&&e===d.getNodeCache(this.setting,e.tId)&&(e.parentTId&&l.expandCollapseParentNode(this.setting,e.getParentNode(),!0),l.editNode(this.setting,e))},t.moveNode=function(e,t,i,n){function a(){l.moveNode(o.setting,e,t,i,!1,n)}if(!t)return t;if(e&&!e.isParent&&this.setting.data.keep.leaf&&i===r.move.TYPE_INNER)return null;if(e&&(t.parentTId==e.tId&&i==r.move.TYPE_INNER||c(t,this.setting).find("#"+e.tId).length>0))return null;e||(e=null);var o=this;return s.canAsync(this.setting,e)&&i===r.move.TYPE_INNER?l.asyncNode(this.setting,e,n,a):a(),t},t.setEditable=function(e){return this.setting.edit.enable=e,this.refresh()}});var h=l.cancelPreSelectedNode;l.cancelPreSelectedNode=function(e,t){for(var i=d.getRoot(e).curSelectedList,n=0,a=i.length;n<a&&(t&&t!==i[n]||(l.removeTreeDom(e,i[n]),!t));n++);h&&h.apply(l,arguments)};var u=l.createNodes;l.createNodes=function(e,t,i,n){u&&u.apply(l,arguments),i&&l.repairParentChkClassWithSelf&&l.repairParentChkClassWithSelf(e,n)};var p=l.makeNodeUrl;l.makeNodeUrl=function(e,t){return e.edit.enable?null:p.apply(l,arguments)};var f=l.removeNode;l.removeNode=function(e,t){var i=d.getRoot(e);i.curEditNode===t&&(i.curEditNode=null),f&&f.apply(l,arguments)};var g=l.selectNode;l.selectNode=function(e,t,i){var n=d.getRoot(e);return(!d.isSelectedNode(e,t)||n.curEditNode!=t||!t.editNameFlag)&&(g&&g.apply(l,arguments),l.addHoverDom(e,t),!0)};var v=s.uCanDo;s.uCanDo=function(e,t){var i=d.getRoot(e);return!(!t||!(s.eqs(t.type,"mouseover")||s.eqs(t.type,"mouseout")||s.eqs(t.type,"mousedown")||s.eqs(t.type,"mouseup")))||(i.curEditNode&&(l.editNodeBlur=!1,i.curEditInput.focus()),!i.curEditNode&&(!v||v.apply(l,arguments)))}}(jQuery),Number.prototype.div=function(e){return accDiv(this,e)},Number.prototype.mul=function(e){return accMul(e,this)},Number.prototype.add=function(e){return accAdd(e,this)},Number.prototype.subtr=function(e){return accSubtr(this,e)};